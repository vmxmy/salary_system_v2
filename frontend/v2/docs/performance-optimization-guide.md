# æ€§èƒ½ä¼˜åŒ–æŒ‡å—

## ğŸ¯ å½“å‰æ€§èƒ½é—®é¢˜åˆ†æ

æ ¹æ®æ§åˆ¶å°ç›‘æ§æ•°æ®ï¼Œå‘ç°ä»¥ä¸‹æ€§èƒ½ç“¶é¢ˆï¼š

### ğŸŒ ææ…¢è¯·æ±‚ï¼ˆ>1000msï¼‰
- `GET /payroll-entries` - **5865ms** âš ï¸ éœ€è¦ç´§æ€¥ä¼˜åŒ–
- `GET /personnel-categories` - **1881ms**
- `GET /departments` - **1896ms**
- `GET /lookup/types` - **1171ms**

### ğŸ”„ ä¸­ç­‰æ…¢è¯·æ±‚ï¼ˆ150-1000msï¼‰
- å¤šä¸ª `GET /payroll-runs` - **600-1500ms**
- å„ç§ lookup è¯·æ±‚ - **600-1000ms**

## ğŸš€ å·²å®æ–½çš„ä¼˜åŒ–æªæ–½

### 1. æ§åˆ¶å°è¿‡æ»¤ä¼˜åŒ–
- âœ… è¿‡æ»¤ React åºŸå¼ƒè­¦å‘Š
- âœ… è§£å†³ CSP å®‰å…¨ç­–ç•¥é—®é¢˜
- âœ… å¤–éƒ¨è„šæœ¬åŠ è½½ä¼˜åŒ–

### 2. æ€§èƒ½ç›‘æ§ç³»ç»Ÿ
- âœ… è¯·æ±‚è€—æ—¶ç›‘æ§
- âœ… å†…å­˜ä½¿ç”¨ç›‘æ§
- âœ… æ…¢è¯·æ±‚åˆ†ç±»å’Œè­¦å‘Š

### 3. æ•°æ®åŠ è½½ä¼˜åŒ–
- âœ… åˆ†æ‰¹åŠ è½½ HR lookups
- âœ… å‡å°‘å¹¶å‘è¯·æ±‚æ•°é‡
- âœ… ä¼˜å…ˆåŠ è½½é‡è¦æ•°æ®

## ğŸ“‹ å¾…å®æ–½çš„ä¼˜åŒ–å»ºè®®

### 1. åç«¯ä¼˜åŒ–ï¼ˆæ¨èï¼‰
```sql
-- ä¸ºæ…¢æŸ¥è¯¢æ·»åŠ ç´¢å¼•
CREATE INDEX idx_payroll_entries_period ON payroll_entries(period_id);
CREATE INDEX idx_personnel_categories_active ON personnel_categories(is_active);
CREATE INDEX idx_departments_parent ON departments(parent_id);
```

### 2. å‰ç«¯ç¼“å­˜ç­–ç•¥
```typescript
// å®æ–½æ™ºèƒ½ç¼“å­˜
const cacheConfig = {
  lookupData: 10 * 60 * 1000,    // 10åˆ†é’Ÿ
  departmentData: 15 * 60 * 1000, // 15åˆ†é’Ÿ
  payrollData: 2 * 60 * 1000,    // 2åˆ†é’Ÿ
};
```

### 3. åˆ†é¡µå’Œè™šæ‹Ÿæ»šåŠ¨
- å¯¹å¤§æ•°æ®é›†å®æ–½åˆ†é¡µ
- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–é•¿åˆ—è¡¨
- æ‡’åŠ è½½éå…³é”®æ•°æ®

### 4. è¯·æ±‚ä¼˜åŒ–
- åˆå¹¶ç›¸ä¼¼è¯·æ±‚
- å®æ–½è¯·æ±‚å»é‡
- æ·»åŠ è¯·æ±‚å–æ¶ˆæœºåˆ¶

## ğŸ”§ ä½¿ç”¨æ€§èƒ½å·¥å…·

### å¯ç”¨æ€§èƒ½ç›‘æ§
```typescript
// åœ¨ main.tsx ä¸­å·²å¯ç”¨
import PerformanceMonitor from './components/common/PerformanceMonitor';
```

### é…ç½®æ€§èƒ½çº§åˆ«
```typescript
// åœ¨ performanceConfig.ts ä¸­é…ç½®
export const CURRENT_PERFORMANCE_LEVEL = PerformanceLevel.DETAILED;
```

### ç›‘æ§æ…¢è¯·æ±‚
```typescript
// è‡ªåŠ¨ç›‘æ§è¶…è¿‡é˜ˆå€¼çš„è¯·æ±‚
SLOW_REQUEST_THRESHOLD: 150,      // æ…¢è¯·æ±‚é˜ˆå€¼
VERY_SLOW_REQUEST_THRESHOLD: 1000, // ææ…¢è¯·æ±‚é˜ˆå€¼
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡ç›®æ ‡

### çŸ­æœŸç›®æ ‡ï¼ˆ1å‘¨å†…ï¼‰
- [ ] å°† payroll-entries è¯·æ±‚æ—¶é—´é™è‡³ <2000ms
- [ ] ä¼˜åŒ– departments å’Œ personnel-categories æŸ¥è¯¢
- [ ] å®æ–½åŸºç¡€ç¼“å­˜ç­–ç•¥

### ä¸­æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] æ‰€æœ‰ API è¯·æ±‚ <500ms
- [ ] å®æ–½å®Œæ•´çš„ç¼“å­˜ç³»ç»Ÿ
- [ ] æ·»åŠ åˆ†é¡µå’Œè™šæ‹Ÿæ»šåŠ¨

### é•¿æœŸç›®æ ‡ï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] é¦–å±åŠ è½½æ—¶é—´ <2ç§’
- [ ] å†…å­˜ä½¿ç”¨ç¨³å®šåœ¨ <50MB
- [ ] å®ç°ç¦»çº¿ç¼“å­˜åŠŸèƒ½

## ğŸ› ï¸ å¼€å‘è€…å·¥å…·

### æ€§èƒ½ç›‘æ§é¢æ¿
åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå³ä¸Šè§’ä¼šæ˜¾ç¤ºæ€§èƒ½ç›‘æ§é¢æ¿ï¼ŒåŒ…å«ï¼š
- å®æ—¶å†…å­˜ä½¿ç”¨æƒ…å†µ
- è¯·æ±‚è€—æ—¶ç»Ÿè®¡
- æ€§èƒ½è­¦å‘Šæç¤º

### æ§åˆ¶å°æ—¥å¿—
- `ğŸš€ ç¼“å­˜å‘½ä¸­` - ç¼“å­˜æˆåŠŸä½¿ç”¨
- `âš ï¸ æ…¢è¯·æ±‚è­¦å‘Š` - è¯·æ±‚è¶…è¿‡é˜ˆå€¼
- `ğŸŒ ææ…¢è¯·æ±‚` - éœ€è¦ç´§æ€¥ä¼˜åŒ–çš„è¯·æ±‚
- `ğŸ’¾ ç¼“å­˜å·²ä¿å­˜` - æ•°æ®å·²ç¼“å­˜

## ğŸ“ æœ€ä½³å®è·µ

1. **æ•°æ®è·å–**
   - ä¼˜å…ˆåŠ è½½å…³é”®æ•°æ®
   - å»¶è¿ŸåŠ è½½éå…³é”®æ•°æ®
   - ä½¿ç”¨é€‚å½“çš„ç¼“å­˜ç­–ç•¥

2. **ç»„ä»¶ä¼˜åŒ–**
   - ä½¿ç”¨ React.memo é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
   - åˆç†ä½¿ç”¨ useMemo å’Œ useCallback
   - é¿å…åœ¨æ¸²æŸ“ä¸­è¿›è¡Œå¤æ‚è®¡ç®—

3. **ç½‘ç»œè¯·æ±‚**
   - åˆå¹¶ç›¸ä¼¼è¯·æ±‚
   - å®æ–½è¯·æ±‚å»é‡
   - æ·»åŠ é€‚å½“çš„è¶…æ—¶è®¾ç½®

4. **å†…å­˜ç®¡ç†**
   - åŠæ—¶æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
   - é¿å…å†…å­˜æ³„æ¼
   - ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ 