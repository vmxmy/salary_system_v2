var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{b as n}from"./react-vendor-D9vUlElp.js";const r=e=>{const{componentName:t,warningThreshold:r=10,enableLogging:s=!1,enableProfiling:c=!1}=e,a=n.useRef(0),o=n.useRef([]),u=n.useRef(0),i=n.useRef(Date.now());a.current+=1;const l=a.current;if(c){const e=Date.now();o.current.push(e),o.current.length>20&&(o.current=o.current.slice(-20))}const g=l>r;n.useEffect((()=>{if(s&&g){const e=Date.now();if(e-u.current>1e3){u.current=e;i.current}}}),[t,l,g,r,s]);return{renderCount:l,isExcessive:g,resetCount:()=>{a.current=0,o.current=[],i.current=Date.now(),u.current=0},getStats:()=>{Date.now();i.current;const e=o.current.length>1?o.current.reduce(((e,t,n)=>0===n?0:e+(t-o.current[n-1])),0)/(o.current.length-1):0;return{componentName:t,totalRenders:l,averageRenderTime:e,lastRenderTime:o.current[o.current.length-1]||i.current,isExcessive:g,warningThreshold:r}}}},s=class e{constructor(){t(this,"stats",new Map)}static getInstance(){return e.instance||(e.instance=new e),e.instance}registerComponent(e){this.stats.set(e.componentName,e)}getComponentStats(e){return this.stats.get(e)}getAllStats(){return Array.from(this.stats.values())}getExcessiveComponents(){return this.getAllStats().filter((e=>e.isExcessive))}clearStats(){this.stats.clear()}generateReport(){const e=this.getAllStats(),t=this.getExcessiveComponents();let n="📊 渲染性能报告\n";return n+=`总计监控组件: ${e.length}\n`,n+=`异常渲染组件: ${t.length}\n\n`,t.length>0?(n+="⚠️ 异常渲染组件详情:\n",t.forEach((e=>{n+=`  • ${e.componentName}: ${e.totalRenders} 次渲染 (阈值: ${e.warningThreshold})\n`,n+=`    平均渲染间隔: ${e.averageRenderTime.toFixed(2)}ms\n`}))):n+="✅ 所有组件渲染正常\n",n}};t(s,"instance");const c=s.getInstance(),a=e=>{const t=r(e),s=n.useRef(t.getStats);return s.current=t.getStats,n.useEffect((()=>{const e=setInterval((()=>{c.registerComponent(s.current())}),1e3);return()=>clearInterval(e)}),[]),t};export{a,r as u};
