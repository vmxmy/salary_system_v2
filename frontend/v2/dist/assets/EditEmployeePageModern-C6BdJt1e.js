import{s as e,j as o,n as s,m as t,S as r,B as l,ba as n,e as m}from"./antd-vendor-DWzn6iQK.js";import{k as a,u as i,b as c}from"./react-vendor-D9vUlElp.js";import{M as d,a as p}from"./index-Rv_gV0PU.js";import{e as y}from"./employee-service-D8n0hVPx.js";import{u as h}from"./i18n-vendor-DF0Yg0Xi.js";import"./state-vendor-BIBp6L7x.js";import"./admin-management-CYhSgojJ.js";import"./hr-management-D97vxp0y.js";import"./payroll-management-BvFUgCwh.js";import"./utils-vendor-CFhz7Dje.js";const u=()=>{const{t:u}=h(["employee","common"]),{employeeId:j}=a(),x=i(),[f,b]=c.useState(null),[g,v]=c.useState(!1),[E,k]=c.useState(!0),[C,N]=c.useState(null),w=c.useCallback((async()=>{if(!j)return N(u("employee:invalidEmployeeId")),void k(!1);try{k(!0),N(null);const e=await y.getEmployeeByIdFromView(j);b(e)}catch(e){const o=e instanceof Error?e.message:u("employee:fetchError");N(o)}finally{k(!1)}}),[j,u]);c.useEffect((()=>{w()}),[w]),c.useCallback((async o=>{if(f)try{v(!0),N(null);const s=await y.updateEmployee(f.id.toString(),o);e.success(u("employee:updateSuccess")),x(`/hr/employees/${s.id}`)}catch(s){const o=s instanceof Error?s.message:u("employee:updateError");N(o),e.error(o)}finally{v(!1)}}),[f,u,x]);const S=c.useCallback((()=>{x(f?`/hr/employees/${f.id}`:"/hr/employees")}),[f,x]),I=e=>{if(!e)return u("employee:unknownEmployee");const o=[e.last_name,e.first_name].filter(Boolean);return o.length>0?o.join(""):e.employee_code||u("employee:unknownEmployee")};if(E)return o.jsx(d,{title:u("employee:editEmployee"),subtitle:u("employee:loading"),children:o.jsx("div",{className:"loading-container d-flex justify-center items-center",style:{height:"400px"},children:o.jsx(s,{size:"large"})})});if(C&&!f)return o.jsx(d,{title:u("employee:editEmployee"),subtitle:u("employee:employeeNotFound"),children:o.jsx(p,{children:o.jsx(t,{message:u("employee:error"),description:C,type:"error",showIcon:!0,action:o.jsxs(r,{children:[o.jsx(l,{size:"small",onClick:()=>x("/hr/employees"),children:u("common:back")}),o.jsx(l,{size:"small",type:"primary",onClick:w,children:u("common:retry")})]})})})});const $=o.jsx(r,{children:o.jsx(l,{icon:o.jsx(n,{}),onClick:S,className:"modern-button variant-ghost",children:u("common:back")})}),B=[{title:u("common:home"),href:"/"},{title:u("common:hrManagement"),href:"/hr"},{title:u("employee:employeeManagement"),href:"/hr/employees"},{title:I(f),href:f?`/hr/employees/${f.id}`:void 0},{title:u("common:edit")}];return o.jsxs(d,{title:`${u("common:edit")} ${I(f)}`,subtitle:`${u("employee:employeeCode")}: ${(null==f?void 0:f.employee_code)||u("common:notSet")}`,headerExtra:$,showBreadcrumb:!0,breadcrumbItems:B,children:[C&&o.jsx(p,{className:"mb-6",children:o.jsx(t,{message:u("employee:error"),description:C,type:"error",showIcon:!0,closable:!0,onClose:()=>N(null)})}),o.jsx(p,{title:u("employee:editEmployeeInformation"),icon:o.jsx(m,{}),variant:"outlined",children:o.jsxs("div",{className:"p-6",children:[o.jsx("p",{className:"typography-body text-secondary",children:u("employee:editEmployeeFormPlaceholder","员工编辑表单将在此处显示")}),o.jsxs(r,{className:"mt-4",children:[o.jsx(l,{onClick:S,className:"modern-button variant-secondary",children:u("common:cancel")}),o.jsx(l,{type:"primary",loading:g,className:"modern-button variant-primary",children:u("common:save")})]})]})})]})};export{u as default};
