var e=Object.defineProperty,t=(t,s,l)=>((t,s,l)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l)(t,"symbol"!=typeof s?s+"":s,l);import{j as s,C as l,r as n,t as r,I as a,S as i,B as o,cl as c,u as d,d as u,b5 as h,a as p,c as m,cp as f,o as g,N as x,aK as y,aw as j,au as b,cu as C,cv as v,aO as S,co as w,s as k,M as _,cd as z,X as V,ce as E,R as F,a1 as M,k as P,g as R,e as D,at as O,l as A,T,Z as N,y as $,F as I,ch as L,cz as Y,b2 as B,aq as U,ci as H,P as W,b as Z,H as q,J,bp as G}from"./antd-vendor-C1V4cVms.js";import{b as K,R as Q,u as X}from"./react-vendor-D9vUlElp.js";import{a as ee}from"./useRenderCount-CIqEsBom.js";import{S as te,F as se}from"./FileSaver.min-BepjGbTF.js";import{u as le}from"./i18n-vendor-DF0Yg0Xi.js";import{a as ne}from"./exceljs.min-BdG9S1UE.js";import{M as re,a as ae}from"./index-CNoCQzrU.js";import{u as ie}from"./admin-management-B_B4TQCC.js";import{g as oe}from"./hr-management-Bxz25n3J.js";import{e as ce}from"./employee-service-EoGCXWnj.js";import"./utils-vendor-CFhz7Dje.js";import"./excel-vendor-BHR_E30J.js";import"./state-vendor-BIBp6L7x.js";import"./payroll-management-BhhUn9Iu.js";const de={searchPanelContainer:"_searchPanelContainer_x8m3o_4",tableContainer:"_tableContainer_x8m3o_9"},{Option:ue}=d,he=[{value:te.AUTO,label:"æ™ºèƒ½æœç´¢",tip:"è‡ªåŠ¨é€‰æ‹©æœ€ä½³æœç´¢æ¨¡å¼"},{value:te.EXACT,label:"ç²¾ç¡®åŒ¹é…",tip:"å®Œå…¨åŒ¹é…æœç´¢å†…å®¹"},{value:te.FUZZY,label:"æ¨¡ç³Šæœç´¢",tip:"æ”¯æŒè¿‘ä¼¼åŒ¹é…å’Œæ‹¼å†™çº é”™"},{value:te.REGEX,label:"æ­£åˆ™è¡¨è¾¾å¼",tip:"æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"},{value:te.SMART,label:"æ™ºèƒ½å»ºè®®",tip:"åŸºäºŽåŽ†å²å’Œå†…å®¹çš„æ™ºèƒ½å»ºè®®"}],pe=({searchQuery:e,searchResults:t,isSearching:x,searchMode:y,suggestions:j,totalResults:b,searchTime:C,isEmptyQuery:v,hasResults:S,performance:w,onSearch:k,onClear:_,onSearchModeChange:z,placeholder:V="è¾“å…¥æœç´¢å…³é”®è¯...",showPerformance:E=!0,searchModes:F=[te.AUTO,te.EXACT,te.FUZZY,te.SMART],supportExpressions:M=!0,collapsible:P=!0,showTips:R=!0})=>{const{t:D}=le(["common"]),[O,A]=K.useState(!1),[T,N]=K.useState(""),$=e=>{N(e),k(e)},I=()=>{N(""),_()};return s.jsxs(l,{title:s.jsxs(n,{justify:"space-between",align:"middle",wrap:!1,children:[s.jsx(r,{flex:"auto",children:s.jsxs(i,{wrap:!0,size:4,align:"center",children:[s.jsx(p,{}),s.jsx("span",{children:D("search.title",{defaultValue:"æ™ºèƒ½æœç´¢"})}),!E||v?null:s.jsxs(i,{size:4,children:[s.jsxs(g,{color:"blue",style:{margin:0},children:[b," æ¡ç»“æžœ",w.isOptimal&&s.jsx("span",{style:{color:"#52c41a"},children:" âš¡"})]}),C>0&&s.jsxs(g,{color:"default",style:{margin:0,fontSize:"11px"},children:[C,"ms"]})]})]})}),P&&s.jsx(r,{flex:"none",children:s.jsx(o,{type:"text",size:"small",onClick:()=>A(!O),icon:O?s.jsx(m,{}):s.jsx(f,{}),style:{fontSize:"12px",padding:"0 4px",height:"24px",lineHeight:"22px"}})})]}),size:"small",style:{marginBottom:16,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e8e8e8"},styles:{body:{padding:O?0:16,display:O?"none":"block"}},children:[s.jsxs(n,{gutter:[12,8],align:"middle",children:[s.jsx(r,{flex:"auto",children:s.jsx(a.Search,{placeholder:V,value:T,onChange:e=>N(e.target.value),onSearch:$,loading:x,allowClear:!0,onClear:I,style:{width:"100%"},suffix:s.jsx(i,{size:4,children:e&&s.jsx(o,{type:"text",size:"small",icon:s.jsx(c,{}),onClick:I,style:{fontSize:"12px",padding:0,width:16,height:16}})})})}),s.jsx(r,{flex:"none",children:s.jsxs(i,{size:8,children:[s.jsx(d,{value:y,onChange:z,size:"small",style:{width:120},popupRender:e=>s.jsxs("div",{children:[e,s.jsx("div",{style:{padding:"8px",borderTop:"1px solid #f0f0f0"},children:s.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[s.jsx(h,{style:{marginRight:4}}),"é€‰æ‹©åˆé€‚çš„æœç´¢æ¨¡å¼"]})})]}),children:he.filter((e=>F.includes(e.value))).map((e=>s.jsx(ue,{value:e.value,children:s.jsx(u,{title:e.tip,placement:"left",children:e.label})},e.value)))}),s.jsx("div",{style:{fontSize:"12px",color:"#666",minWidth:80},children:(()=>{const e=he.find((e=>e.value===y));return e?e.label:"æ™ºèƒ½æœç´¢"})()})]})})]}),(()=>{if(!R||!v)return null;const e=["ðŸ’¡ æ”¯æŒå¤šå…³é”®è¯æœç´¢ï¼Œç”¨ç©ºæ ¼åˆ†éš”"];return M&&e.push("ðŸ”¢ æ”¯æŒæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¦‚: salary>10000"),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:4},children:s.jsx(i,{direction:"vertical",size:0,children:e.map(((e,t)=>s.jsx("span",{children:e},t)))})})})(),j&&0!==j.length&&v?s.jsxs("div",{style:{marginTop:8},children:[s.jsx("span",{style:{fontSize:"12px",color:"#666",marginRight:8},children:"å»ºè®®æœç´¢:"}),s.jsx(i,{size:4,wrap:!0,children:j.slice(0,5).map(((e,t)=>s.jsx(g,{style:{cursor:"pointer",margin:"2px 0"},onClick:()=>$(e),children:e},t)))})]}):null,!v&&S&&s.jsx("div",{style:{marginTop:12,padding:"8px 12px",backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4,fontSize:"12px"},children:s.jsxs(i,{align:"center",children:[s.jsx("span",{style:{color:"#52c41a"},children:"âœ“"}),s.jsxs("span",{children:["æ‰¾åˆ° ",b," æ¡åŒ¹é…ç»“æžœ",C>0&&` (${C}ms)`,w.isOptimal&&s.jsx("span",{style:{color:"#52c41a",marginLeft:4},children:"âš¡ æ€§èƒ½ä¼˜åŒ–"})]})]})}),!v&&!S&&!x&&s.jsxs("div",{style:{marginTop:12,padding:"8px 12px",backgroundColor:"#fff2e8",border:"1px solid #ffd591",borderRadius:4,fontSize:"12px"},children:[s.jsxs(i,{align:"center",children:[s.jsx("span",{style:{color:"#fa8c16"},children:"âš "}),s.jsx("span",{children:"æœªæ‰¾åˆ°åŒ¹é…çš„ç»“æžœï¼Œè¯·å°è¯•:"})]}),s.jsxs("div",{style:{marginTop:4,paddingLeft:20},children:["â€¢ æ£€æŸ¥å…³é”®è¯æ‹¼å†™",s.jsx("br",{}),"â€¢ ä½¿ç”¨æ›´ç®€çŸ­çš„å…³é”®è¯",s.jsx("br",{}),"â€¢ å°è¯•ä¸åŒçš„æœç´¢æ¨¡å¼"]})]})]})},{Panel:me}=y,{Option:fe}=d,ge={hideJsonbColumns:!0,hideZeroColumns:!0,hideEmptyColumns:!0,includePatterns:[],excludePatterns:["*id","*æ—¶é—´","*æ—¥æœŸ"],minValueThreshold:0,maxValueThreshold:1/0,showOnlyNumericColumns:!1,columnSortMode:"byCategory",customColumnOrder:[]},xe=(e,t)=>{const s=t.replace(/\*/g,".*").replace(/\?/g,".");return new RegExp(`^${s}$`,"i").test(e)},ye=(e,t)=>{const s=e.slice(0,100).map((e=>e[t])).filter((e=>null!=e));if(0===s.length)return"text";if(s.filter((e=>"number"==typeof e||!isNaN(Number(e)))).length>.8*s.length)return"number";if(s.filter((e=>{const t=new Date(e);return!isNaN(t.getTime())})).length>.8*s.length)return"date";return s.filter((e=>"boolean"==typeof e)).length>.8*s.length?"boolean":"text"},je=({visible:e,onClose:t,filterConfig:a,onFilterConfigChange:c,dataSource:p,columns:m=[],onColumnsChange:f})=>{const{t:_}=le(["common"]),z=K.useRef(null),[V,E]=K.useState(!1),[F,M]=K.useState(!1),P=K.useRef(null),R=K.useMemo((()=>{if(!p||0===p.length)return[];const e=new Set;return p.forEach((t=>{Object.keys(t).forEach((t=>{"id"===t||"key"===t||t.startsWith("_")||e.add(t)}))})),Array.from(e).sort()}),[p]),D=K.useMemo((()=>{const e={basic:[],contact:[],position:[],salary:[],others:[]};return R.forEach((t=>{const s=t.toLowerCase();s.includes("å§“å")||s.includes("name")||s.includes("ç¼–å·")||s.includes("code")||s.includes("æ€§åˆ«")||s.includes("age")?e.basic.push(t):s.includes("ç”µè¯")||s.includes("phone")||s.includes("é‚®ç®±")||s.includes("email")||s.includes("åœ°å€")||s.includes("address")?e.contact.push(t):s.includes("éƒ¨é—¨")||s.includes("department")||s.includes("èŒä½")||s.includes("position")||s.includes("å²—ä½")||s.includes("job")?e.position.push(t):s.includes("å·¥èµ„")||s.includes("salary")||s.includes("è–ª")||s.includes("wage")||s.includes("æ´¥è´´")||s.includes("bonus")?e.salary.push(t):e.others.push(t)})),e}),[R]),O=K.useMemo((()=>{const e={};return R.forEach((t=>{const s=p.map((e=>e[t])),l=s.filter((e=>null==e||""===e)).length,n=s.filter((e=>0===e||"0"===e)).length,r=s.some((e=>null!=e&&""!==e&&0!==e&&"0"!==e));e[t]={type:ye(p,t),emptyCount:l,zeroCount:n,totalCount:s.length,hasValues:r}})),e}),[R,p]);K.useEffect((()=>()=>{P.current&&clearTimeout(P.current)}),[]);const A=(e,t)=>{c({...a,[e]:t})};return e?s.jsx("div",{ref:z,onMouseEnter:()=>{P.current&&(clearTimeout(P.current),P.current=null),M(!1)},onMouseLeave:()=>{V||(M(!0),P.current=setTimeout((()=>{t()}),2e3))},style:{position:"fixed",top:"20%",right:F?"-280px":"20px",width:"300px",maxHeight:"60vh",zIndex:1001,transition:"right 0.3s ease-in-out",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:s.jsxs(l,{title:s.jsxs(i,{children:[s.jsx(w,{}),_("filter.title",{defaultValue:"åˆ—ç®¡ç†"}),F&&s.jsx(g,{color:"orange",children:_("filter.auto_closing",{defaultValue:"å³å°†æ”¶èµ·"})})]}),size:"small",extra:s.jsxs(i,{children:[s.jsx(u,{title:V?_("filter.unpin",{defaultValue:"å–æ¶ˆå›ºå®š"}):_("filter.pin",{defaultValue:"å›ºå®šé¢æ¿"}),children:s.jsx(o,{type:"text",size:"small",icon:V?s.jsx(C,{}):s.jsx(v,{}),onClick:()=>E(!V)})}),s.jsx(o,{type:"text",size:"small",icon:s.jsx(S,{}),onClick:t})]}),bodyStyle:{maxHeight:"50vh",overflowY:"auto",padding:"12px"},children:[(()=>{const e=R.filter((e=>{var t;return a.hideEmptyColumns&&!(null==(t=O[e])?void 0:t.hasValues)})).length,t=R.filter((e=>{var t,s;return a.hideZeroColumns&&(null==(t=O[e])?void 0:t.zeroCount)===(null==(s=O[e])?void 0:s.totalCount)})).length,l=R.filter((e=>{const t=O[e];if(!t)return!0;if(a.hideEmptyColumns&&!t.hasValues)return!1;if(a.hideZeroColumns&&t.zeroCount===t.totalCount)return!1;if(a.showOnlyNumericColumns&&"number"!==t.type)return!1;if(a.includePatterns.length>0){if(!a.includePatterns.some((t=>xe(e,t))))return!1}if(a.excludePatterns.length>0){if(a.excludePatterns.some((t=>xe(e,t))))return!1}return!0}));return s.jsx("div",{style:{marginBottom:16},children:s.jsxs(n,{gutter:16,children:[s.jsx(r,{span:6,children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#1890ff"},children:R.length}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:_("filter.stats.total_columns",{defaultValue:"æ€»åˆ—æ•°"})})]})}),s.jsx(r,{span:6,children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#52c41a"},children:l.length}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:_("filter.stats.visible_columns",{defaultValue:"å¯è§åˆ—æ•°"})})]})}),s.jsx(r,{span:6,children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#faad14"},children:e}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:_("filter.stats.hidden_empty",{defaultValue:"éšè—ç©ºåˆ—"})})]})}),s.jsx(r,{span:6,children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#f5222d"},children:t}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:_("filter.stats.hidden_zero",{defaultValue:"éšè—é›¶å€¼åˆ—"})})]})})]})})})(),s.jsx(x,{style:{margin:"12px 0"}}),(()=>{const e=[{name:_("filter.presets.basic_info",{defaultValue:"åŸºæœ¬ä¿¡æ¯"}),description:_("filter.presets.basic_info_desc",{defaultValue:"æ˜¾ç¤ºå§“åã€ç¼–å·ã€éƒ¨é—¨ç­‰åŸºæœ¬ä¿¡æ¯"}),config:{includePatterns:["*å§“å*","*name*","*ç¼–å·*","*code*","*éƒ¨é—¨*","*department*"],excludePatterns:[],hideEmptyColumns:!0}},{name:_("filter.presets.contact_info",{defaultValue:"è”ç³»ä¿¡æ¯"}),description:_("filter.presets.contact_info_desc",{defaultValue:"æ˜¾ç¤ºè”ç³»æ–¹å¼ç›¸å…³å­—æ®µ"}),config:{includePatterns:["*ç”µè¯*","*phone*","*é‚®ç®±*","*email*","*åœ°å€*","*address*"],excludePatterns:[],hideEmptyColumns:!0}},{name:_("filter.presets.salary_info",{defaultValue:"è–ªèµ„ä¿¡æ¯"}),description:_("filter.presets.salary_info_desc",{defaultValue:"æ˜¾ç¤ºè–ªèµ„ç›¸å…³å­—æ®µ"}),config:{includePatterns:["*å·¥èµ„*","*salary*","*è–ª*","*wage*","*æ´¥è´´*","*bonus*"],excludePatterns:[],showOnlyNumericColumns:!1}},{name:_("filter.presets.numeric_only",{defaultValue:"ä»…æ•°å€¼åˆ—"}),description:_("filter.presets.numeric_only_desc",{defaultValue:"ä»…æ˜¾ç¤ºæ•°å€¼ç±»åž‹çš„åˆ—"}),config:{showOnlyNumericColumns:!0,hideZeroColumns:!0}}];return s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:_("filter.quick_presets",{defaultValue:"å¿«é€Ÿé¢„è®¾"})}),s.jsx(i,{wrap:!0,children:e.map(((e,t)=>s.jsx(u,{title:e.description,children:s.jsx(o,{size:"small",onClick:()=>{c({...a,...e.config}),k.success(`${_("filter.preset_applied",{defaultValue:"å·²åº”ç”¨é¢„è®¾"})}: ${e.name}`)},children:e.name})},t)))})]})})(),s.jsx(x,{style:{margin:"12px 0"}}),s.jsxs(y,{size:"small",ghost:!0,children:[s.jsx(me,{header:_("filter.basic_filters",{defaultValue:"åŸºç¡€ç­›é€‰"}),children:s.jsxs(i,{direction:"vertical",style:{width:"100%"},size:"small",children:[s.jsxs("div",{children:[s.jsx(j,{size:"small",checked:a.hideEmptyColumns,onChange:e=>A("hideEmptyColumns",e)}),s.jsx("span",{style:{marginLeft:8,fontSize:"13px"},children:_("filter.hide_empty_columns",{defaultValue:"éšè—ç©ºåˆ—"})})]}),s.jsxs("div",{children:[s.jsx(j,{size:"small",checked:a.hideZeroColumns,onChange:e=>A("hideZeroColumns",e)}),s.jsx("span",{style:{marginLeft:8,fontSize:"13px"},children:_("filter.hide_zero_columns",{defaultValue:"éšè—é›¶å€¼åˆ—"})})]}),s.jsxs("div",{children:[s.jsx(j,{size:"small",checked:a.showOnlyNumericColumns,onChange:e=>A("showOnlyNumericColumns",e)}),s.jsx("span",{style:{marginLeft:8,fontSize:"13px"},children:_("filter.numeric_only",{defaultValue:"ä»…æ˜¾ç¤ºæ•°å€¼åˆ—"})})]})]})},"basic"),s.jsx(me,{header:_("filter.pattern_filters",{defaultValue:"æ¨¡å¼ç­›é€‰"}),children:s.jsxs(i,{direction:"vertical",style:{width:"100%"},size:"small",children:[s.jsxs("div",{children:[s.jsxs("div",{style:{fontSize:"13px",marginBottom:4},children:[_("filter.include_patterns",{defaultValue:"åŒ…å«æ¨¡å¼"}),s.jsx(u,{title:_("filter.pattern_help",{defaultValue:"ä½¿ç”¨*ä½œä¸ºé€šé…ç¬¦ï¼Œå¦‚: *name*, salary*"}),children:s.jsx(h,{style:{marginLeft:4,fontSize:"12px"}})})]}),s.jsx(d,{mode:"tags",size:"small",style:{width:"100%"},placeholder:_("filter.pattern_placeholder",{defaultValue:"è¾“å…¥æ¨¡å¼ï¼Œå¦‚: *name*"}),value:a.includePatterns,onChange:e=>A("includePatterns",e)})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",marginBottom:4},children:_("filter.exclude_patterns",{defaultValue:"æŽ’é™¤æ¨¡å¼"})}),s.jsx(d,{mode:"tags",size:"small",style:{width:"100%"},placeholder:_("filter.exclude_placeholder",{defaultValue:"è¾“å…¥è¦æŽ’é™¤çš„æ¨¡å¼"}),value:a.excludePatterns,onChange:e=>A("excludePatterns",e)})]})]})},"patterns"),s.jsx(me,{header:_("filter.column_groups",{defaultValue:"åˆ—åˆ†ç»„"}),children:s.jsx(i,{direction:"vertical",style:{width:"100%"},size:"small",children:Object.entries(D).map((([e,t])=>t.length>0&&s.jsxs("div",{children:[s.jsxs("div",{style:{fontSize:"13px",fontWeight:500,marginBottom:4},children:[_(`filter.groups.${e}`,{defaultValue:e})," (",t.length,")"]}),s.jsxs("div",{style:{paddingLeft:8},children:[t.slice(0,3).map((e=>s.jsx(g,{style:{margin:"1px"},children:e.length>12?`${e.substring(0,12)}...`:e},e))),t.length>3&&s.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:["+",t.length-3," more"]})]})]},e)))})},"groups")]}),s.jsx(x,{style:{margin:"12px 0"}}),s.jsxs(i,{style:{width:"100%",justifyContent:"center"},children:[s.jsx(o,{size:"small",icon:s.jsx(b,{}),onClick:()=>{c(ge),k.success(_("filter.reset_success",{defaultValue:"ç­›é€‰æ¡ä»¶å·²é‡ç½®"}))},children:_("filter.reset",{defaultValue:"é‡ç½®"})}),s.jsx(o,{size:"small",type:"primary",onClick:t,children:_("filter.apply",{defaultValue:"åº”ç”¨"})})]})]})}):null},{Text:be,Title:Ce}=T,{Panel:ve}=y,{Option:Se}=d,we=({visible:e,onClose:t,onSave:l,categories:i=[],allowPublic:c=!1})=>{const{t:u}=le(["common"]),[h]=U.useForm(),[p,m]=K.useState(!1);return s.jsx(_,{title:u("preset.save_title",{defaultValue:"ä¿å­˜é¢„è®¾é…ç½®"}),open:e,onCancel:t,footer:[s.jsx(o,{onClick:t,children:u("common.cancel",{defaultValue:"å–æ¶ˆ"})},"cancel"),s.jsx(o,{type:"primary",loading:p,onClick:async()=>{try{m(!0);const e=await h.validateFields(),s={category:e.category,isDefault:e.isDefault||!1,isPublic:c&&e.isPublic||!1,description:e.description};await l(e.name,e.description,s),h.resetFields(),t(),k.success(u("preset.save_success",{defaultValue:"é¢„è®¾ä¿å­˜æˆåŠŸ"}))}catch(e){}finally{m(!1)}},children:u("common.save",{defaultValue:"ä¿å­˜"})},"save")],width:480,children:s.jsxs(U,{form:h,layout:"vertical",children:[s.jsx(U.Item,{label:u("preset.name",{defaultValue:"é¢„è®¾åç§°"}),name:"name",rules:[{required:!0,message:u("preset.name_required",{defaultValue:"è¯·è¾“å…¥é¢„è®¾åç§°"})},{max:50,message:u("preset.name_too_long",{defaultValue:"åç§°ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦"})}],children:s.jsx(a,{placeholder:u("preset.name_placeholder",{defaultValue:"è¯·è¾“å…¥é¢„è®¾åç§°"})})}),s.jsx(U.Item,{label:u("preset.description",{defaultValue:"æè¿°"}),name:"description",children:s.jsx(a.TextArea,{rows:3,placeholder:u("preset.description_placeholder",{defaultValue:"è¯·è¾“å…¥é¢„è®¾æè¿°(å¯é€‰)"}),maxLength:200})}),i.length>0&&s.jsx(U.Item,{label:u("preset.category",{defaultValue:"åˆ†ç±»"}),name:"category",children:s.jsx(d,{placeholder:u("preset.category_placeholder",{defaultValue:"é€‰æ‹©åˆ†ç±»(å¯é€‰)"}),allowClear:!0,children:i.map((e=>s.jsx(Se,{value:e,children:e},e)))})}),s.jsxs(n,{gutter:16,children:[s.jsx(r,{span:12,children:s.jsx(U.Item,{name:"isDefault",valuePropName:"checked",children:s.jsxs("div",{children:[s.jsx(H,{style:{marginRight:8,color:"#faad14"}}),u("preset.set_as_default",{defaultValue:"è®¾ä¸ºé»˜è®¤"})]})})}),c&&s.jsx(r,{span:12,children:s.jsx(U.Item,{name:"isPublic",valuePropName:"checked",children:s.jsxs("div",{children:[s.jsx(Y,{style:{marginRight:8,color:"#1890ff"}}),u("preset.make_public",{defaultValue:"å…¬å¼€å…±äº«"})]})})})]})]})})},ke=({visible:e,preset:t,onClose:l,onUpdate:i,categories:c=[],allowPublic:u=!1})=>{const{t:h}=le(["common"]),[p]=U.useForm(),[m,f]=K.useState(!1);Q.useEffect((()=>{t&&e&&p.setFieldsValue({name:t.name,description:t.description,category:t.category,isDefault:t.isDefault,isPublic:t.isPublic})}),[t,e,p]);return s.jsx(_,{title:h("preset.edit_title",{defaultValue:"ç¼–è¾‘é¢„è®¾é…ç½®"}),open:e,onCancel:l,footer:[s.jsx(o,{onClick:l,children:h("common.cancel",{defaultValue:"å–æ¶ˆ"})},"cancel"),s.jsx(o,{type:"primary",loading:m,onClick:async()=>{if(t)try{f(!0);const e=await p.validateFields(),s={...t,name:e.name,description:e.description,category:e.category,isDefault:e.isDefault||!1,isPublic:u?e.isPublic||!1:t.isPublic,updatedAt:N().toISOString()};await i(s),l(),k.success(h("preset.update_success",{defaultValue:"é¢„è®¾æ›´æ–°æˆåŠŸ"}))}catch(e){}finally{f(!1)}},children:h("common.update",{defaultValue:"æ›´æ–°"})},"update")],width:480,children:s.jsxs(U,{form:p,layout:"vertical",children:[s.jsx(U.Item,{label:h("preset.name",{defaultValue:"é¢„è®¾åç§°"}),name:"name",rules:[{required:!0,message:h("preset.name_required",{defaultValue:"è¯·è¾“å…¥é¢„è®¾åç§°"})},{max:50,message:h("preset.name_too_long",{defaultValue:"åç§°ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦"})}],children:s.jsx(a,{placeholder:h("preset.name_placeholder",{defaultValue:"è¯·è¾“å…¥é¢„è®¾åç§°"})})}),s.jsx(U.Item,{label:h("preset.description",{defaultValue:"æè¿°"}),name:"description",children:s.jsx(a.TextArea,{rows:3,placeholder:h("preset.description_placeholder",{defaultValue:"è¯·è¾“å…¥é¢„è®¾æè¿°(å¯é€‰)"}),maxLength:200})}),c.length>0&&s.jsx(U.Item,{label:h("preset.category",{defaultValue:"åˆ†ç±»"}),name:"category",children:s.jsx(d,{placeholder:h("preset.category_placeholder",{defaultValue:"é€‰æ‹©åˆ†ç±»(å¯é€‰)"}),allowClear:!0,children:c.map((e=>s.jsx(Se,{value:e,children:e},e)))})}),s.jsxs(n,{gutter:16,children:[s.jsx(r,{span:12,children:s.jsx(U.Item,{name:"isDefault",valuePropName:"checked",children:s.jsxs("div",{children:[s.jsx(H,{style:{marginRight:8,color:"#faad14"}}),h("preset.set_as_default",{defaultValue:"è®¾ä¸ºé»˜è®¤"})]})})}),u&&s.jsx(r,{span:12,children:s.jsx(U.Item,{name:"isPublic",valuePropName:"checked",children:s.jsxs("div",{children:[s.jsx(Y,{style:{marginRight:8,color:"#1890ff"}}),h("preset.make_public",{defaultValue:"å…¬å¼€å…±äº«"})]})})})]})]})})},_e=({visible:e,onClose:t,currentConfig:c,presets:h=[],onApplyPreset:p,onSavePreset:m,onDeletePreset:f,categories:x=[],title:j="é…ç½®é¢„è®¾ç®¡ç†",allowPublic:b=!1,showUsageStats:C=!0})=>{const{t:v}=le(["common"]),[S,w]=K.useState(!1),[T,U]=K.useState(!1),[H,W]=K.useState(null),[Z,q]=K.useState(""),[J,G]=K.useState(),Q=K.useMemo((()=>{const e=h.filter((e=>{var t;const s=!Z||e.name.toLowerCase().includes(Z.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(Z.toLowerCase())),l=!J||e.category===J;return s&&l})),t={};return e.forEach((e=>{const s=e.category||v("preset.uncategorized",{defaultValue:"æœªåˆ†ç±»"});t[s]||(t[s]=[]),t[s].push(e)})),Object.keys(t).forEach((e=>{t[e].sort(((e,t)=>{if(e.isFavorite&&!t.isFavorite)return-1;if(!e.isFavorite&&t.isFavorite)return 1;if(e.isDefault&&!t.isDefault)return-1;if(!e.isDefault&&t.isDefault)return 1;if(C){const s=(t.usageCount||0)-(e.usageCount||0);if(0!==s)return s}return e.name.localeCompare(t.name)}))})),t}),[h,Z,J,v,C]),X=K.useMemo((()=>{const e=Array.from(new Set(h.map((e=>e.category)).filter(Boolean)));return[...x,...e]}),[x,h]),ee=e=>{const t=[s.jsx(u,{title:v("preset.apply",{defaultValue:"åº”ç”¨"}),children:s.jsx(o,{type:"primary",size:"small",icon:s.jsx(P,{}),onClick:()=>(e=>{p(e),k.success(`${v("preset.applied",{defaultValue:"å·²åº”ç”¨é¢„è®¾"})}: ${e.name}`)})(e),children:v("preset.apply",{defaultValue:"åº”ç”¨"})})},"apply"),s.jsx(u,{title:v("preset.copy",{defaultValue:"å¤åˆ¶"}),children:s.jsx(o,{size:"small",icon:s.jsx(R,{}),onClick:()=>(e=>{const t=`${e.name} - ${v("preset.copy",{defaultValue:"å‰¯æœ¬"})}`;m(t,e.description,{category:e.category,config:e.config}),k.success(`${v("preset.copied",{defaultValue:"å·²å¤åˆ¶é¢„è®¾"})}: ${t}`)})(e)})},"copy"),s.jsx(u,{title:v("preset.edit",{defaultValue:"ç¼–è¾‘"}),children:s.jsx(o,{size:"small",icon:s.jsx(D,{}),onClick:()=>{W(e),U(!0)}})},"edit"),s.jsx(O,{title:v("preset.delete_confirm",{defaultValue:"ç¡®å®šåˆ é™¤æ­¤é¢„è®¾å—ï¼Ÿ"}),onConfirm:()=>(e=>{f(e.id),k.success(`${v("preset.deleted",{defaultValue:"å·²åˆ é™¤é¢„è®¾"})}: ${e.name}`)})(e),okText:v("common.ok",{defaultValue:"ç¡®å®š"}),cancelText:v("common.cancel",{defaultValue:"å–æ¶ˆ"}),children:s.jsx(u,{title:v("preset.delete",{defaultValue:"åˆ é™¤"}),children:s.jsx(o,{size:"small",danger:!0,icon:s.jsx(A,{})})})},"delete")];return s.jsx(E.Item,{actions:t,children:s.jsx(E.Item.Meta,{avatar:s.jsx(B,{size:"small",style:{backgroundColor:e.isDefault?"#faad14":"#1890ff"},children:e.isDefault?s.jsx(L,{}):s.jsx(M,{})}),title:s.jsxs(i,{children:[s.jsx("span",{children:e.name}),e.isFavorite&&s.jsx(L,{style:{color:"#faad14"}}),e.isPublic&&s.jsx(Y,{style:{color:"#1890ff"}}),e.isDefault&&s.jsx(g,{color:"gold",children:v("preset.default",{defaultValue:"é»˜è®¤"})})]}),description:s.jsxs("div",{children:[e.description&&s.jsx("div",{style:{marginBottom:4},children:s.jsx(be,{type:"secondary",style:{fontSize:"12px"},children:e.description})}),s.jsxs(i,{size:"small",children:[s.jsxs(be,{type:"secondary",style:{fontSize:"11px"},children:[s.jsx($,{style:{marginRight:2}}),N(e.updatedAt).format("YYYY-MM-DD HH:mm")]}),C&&e.usageCount>0&&s.jsxs(be,{type:"secondary",style:{fontSize:"11px"},children:["ä½¿ç”¨ ",e.usageCount," æ¬¡"]}),e.creator&&s.jsxs(be,{type:"secondary",style:{fontSize:"11px"},children:[s.jsx(I,{style:{marginRight:2}}),e.creator]})]})]})})})};return s.jsxs(s.Fragment,{children:[s.jsxs(_,{title:s.jsxs(i,{children:[s.jsx(M,{}),j]}),open:e,onCancel:t,footer:[s.jsx(o,{type:"primary",icon:s.jsx(F,{}),onClick:()=>w(!0),children:v("preset.save_current",{defaultValue:"ä¿å­˜å½“å‰é…ç½®"})},"save"),s.jsx(o,{onClick:t,children:v("common.close",{defaultValue:"å…³é—­"})},"close")],width:800,style:{top:50},children:[s.jsxs(n,{gutter:16,style:{marginBottom:16},children:[s.jsx(r,{span:16,children:s.jsx(a.Search,{placeholder:v("preset.search_placeholder",{defaultValue:"æœç´¢é¢„è®¾åç§°æˆ–æè¿°..."}),value:Z,onChange:e=>q(e.target.value),onSearch:q,allowClear:!0})}),s.jsx(r,{span:8,children:s.jsx(d,{placeholder:v("preset.filter_category",{defaultValue:"æŒ‰åˆ†ç±»ç­›é€‰"}),value:J,onChange:G,allowClear:!0,style:{width:"100%"},children:X.map((e=>s.jsxs(Se,{value:e,children:[s.jsx(z,{style:{marginRight:4}}),e]},e)))})})]}),s.jsx(l,{size:"small",style:{marginBottom:16,backgroundColor:"#fafafa"},children:s.jsxs(n,{gutter:16,style:{textAlign:"center"},children:[s.jsxs(r,{span:6,children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#1890ff"},children:h.length}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:v("preset.total_count",{defaultValue:"æ€»é¢„è®¾æ•°"})})]}),s.jsxs(r,{span:6,children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#52c41a"},children:h.filter((e=>e.isFavorite)).length}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:v("preset.favorite_count",{defaultValue:"æ”¶è—æ•°"})})]}),s.jsxs(r,{span:6,children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#faad14"},children:h.filter((e=>e.isDefault)).length}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:v("preset.default_count",{defaultValue:"é»˜è®¤é¢„è®¾"})})]}),s.jsxs(r,{span:6,children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#722ed1"},children:Object.keys(Q).length}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:v("preset.category_count",{defaultValue:"åˆ†ç±»æ•°"})})]})]})}),s.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:0===Object.keys(Q).length?s.jsx(V,{description:v("preset.no_presets",{defaultValue:"æš‚æ— é¢„è®¾é…ç½®"})}):s.jsx(y,{defaultActiveKey:Object.keys(Q),ghost:!0,children:Object.entries(Q).map((([e,t])=>s.jsx(ve,{header:s.jsxs(i,{children:[s.jsx(z,{}),s.jsx("span",{children:e}),s.jsx(g,{children:t.length})]}),children:s.jsx(E,{dataSource:t,renderItem:ee,size:"small"})},e)))})})]}),s.jsx(we,{visible:S,onClose:()=>w(!1),onSave:m,categories:X,allowPublic:b}),s.jsx(ke,{visible:T,preset:H,onClose:()=>{U(!1),W(null)},onUpdate:e=>{k.success(v("preset.update_success",{defaultValue:"é¢„è®¾æ›´æ–°æˆåŠŸ"}))},categories:X,allowPublic:b})]})},ze={hideJsonbColumns:!0,hideZeroColumns:!0,hideEmptyColumns:!0,includePatterns:[],excludePatterns:["*id","*ID","*_id","*æ—¶é—´","*æ—¥æœŸ","*Time","*Date","createdAt","updatedAt"],minValueThreshold:0,maxValueThreshold:1/0,showOnlyNumericColumns:!1,columnSortMode:"byCategory",customColumnOrder:[]},Ve=(e,t)=>{const s=t.replace(/\*/g,".*").replace(/\?/g,".");return new RegExp(`^${s}$`,"i").test(e)},Ee=(e,t)=>{if(!e||0===e.length)return"text";const s=e.slice(0,100).map((e=>e[t])).filter((e=>null!=e&&""!==e));if(0===s.length)return"text";if(s.filter((e=>"object"==typeof e&&null!==e)).length>.5*s.length)return"json";if(s.filter((e=>{const t="number"==typeof e?e:Number(e);return!isNaN(t)&&isFinite(t)})).length>.8*s.length)return"number";if(s.filter((e=>{const t=new Date(e);return!isNaN(t.getTime())&&t.getFullYear()>1900})).length>.8*s.length)return"date";return s.filter((e=>"boolean"==typeof e||"string"==typeof e&&["true","false","æ˜¯","å¦","yes","no"].includes(e.toLowerCase()))).length>.8*s.length?"boolean":"text"},Fe=(e,t)=>{if(null==e)return"-";switch(t){case"number":const t="number"==typeof e?e:Number(e);return isNaN(t)?e:t.toLocaleString();case"date":try{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString()}catch{return e}case"boolean":if("boolean"==typeof e)return e?"æ˜¯":"å¦";if("string"==typeof e){const t=e.toLowerCase();if(["true","yes","æ˜¯","1"].includes(t))return"æ˜¯";if(["false","no","å¦","0"].includes(t))return"å¦"}return e;case"json":return"object"==typeof e?"[JSON Object]":e;default:return e}},Me=e=>{const t=e.toLowerCase();return t.includes("name")||t.includes("å§“å")||t.includes("code")||t.includes("ç¼–å·")||t.includes("id")||t.includes("num")?"åŸºæœ¬ä¿¡æ¯":t.includes("phone")||t.includes("ç”µè¯")||t.includes("email")||t.includes("é‚®ç®±")||t.includes("address")||t.includes("åœ°å€")?"è”ç³»ä¿¡æ¯":t.includes("department")||t.includes("éƒ¨é—¨")||t.includes("position")||t.includes("èŒä½")||t.includes("job")||t.includes("å²—ä½")?"èŒä½ä¿¡æ¯":t.includes("salary")||t.includes("å·¥èµ„")||t.includes("wage")||t.includes("è–ª")||t.includes("bonus")||t.includes("å¥–é‡‘")||t.includes("allowance")||t.includes("æ´¥è´´")?"è–ªèµ„ä¿¡æ¯":t.includes("time")||t.includes("æ—¶é—´")||t.includes("date")||t.includes("æ—¥æœŸ")||t.includes("created")||t.includes("updated")?"æ—¶é—´ä¿¡æ¯":"å…¶ä»–ä¿¡æ¯"},Pe=e=>{const{data:t,searchResults:l,searchMode:n=te.AUTO,filterConfig:r,autoGenerateColumns:a=!0,columnCategories:i=[],defaultHiddenColumns:o=[],numericColumns:c=[]}=e,[d,u]=K.useState({...ze,...r}),[h,p]=K.useState([]);K.useEffect((()=>{r&&u((e=>({...e,...r})))}),[r]);const m=K.useMemo((()=>{if(!t||0===t.length)return[];const e=new Set;return t.forEach((t=>{"object"==typeof t&&null!==t&&Object.keys(t).forEach((t=>{t.startsWith("_")||"key"===t||e.add(t)}))})),Array.from(e).sort()}),[t]),f=K.useMemo((()=>{const e={};return t&&0!==t.length?(m.forEach((s=>{const l=t.map((e=>e[s])),n=l.filter((e=>null!=e&&""!==e)),r=l.length-n.length,a=l.filter((e=>0===e||"0"===e)).length,i=new Set(n).size;e[s]={type:Ee(t,s),emptyCount:r,zeroCount:a,totalCount:l.length,hasValues:n.length>0,uniqueValues:i}})),e):e}),[t,m]),g=K.useMemo((()=>m.filter((e=>{const t=f[e];if(!t)return!0;if(d.hideEmptyColumns&&!t.hasValues)return!1;if(d.hideZeroColumns&&t.zeroCount===t.totalCount)return!1;if(d.hideJsonbColumns&&"json"===t.type)return!1;if(d.showOnlyNumericColumns&&"number"!==t.type)return!1;if(d.includePatterns.length>0){if(!d.includePatterns.some((t=>Ve(e,t))))return!1}if(d.excludePatterns.length>0){if(d.excludePatterns.some((t=>Ve(e,t))))return!1}return!0}))),[m,f,d]),x=K.useMemo((()=>{const e=g.map((e=>({name:e,category:Me(e),stats:f[e],importance:Re(e)})));switch(d.columnSortMode){case"byCategory":return e.sort(((e,t)=>{const s=["åŸºæœ¬ä¿¡æ¯","è”ç³»ä¿¡æ¯","èŒä½ä¿¡æ¯","è–ªèµ„ä¿¡æ¯","æ—¶é—´ä¿¡æ¯","å…¶ä»–ä¿¡æ¯"],l=s.indexOf(e.category),n=s.indexOf(t.category);return l!==n?l-n:e.importance-t.importance})).map((e=>e.name));case"byAlphabet":return e.sort(((e,t)=>e.name.localeCompare(t.name))).map((e=>e.name));case"byImportance":return e.sort(((e,t)=>e.importance-t.importance)).map((e=>e.name));case"byDataType":return e.sort(((e,t)=>{const s=["number","text","date","boolean","json"];return s.indexOf(e.stats.type)-s.indexOf(t.stats.type)})).map((e=>e.name));case"custom":if(d.customColumnOrder&&d.customColumnOrder.length>0){const e=d.customColumnOrder;return[...e.filter((e=>g.includes(e))),...g.filter((t=>!e.includes(t)))]}return g;default:return g}}),[g,f,d]),y=K.useCallback(((e,t,n={},r)=>{if(!e||0===e.length)return[];const{maxColumnWidth:a=200,ellipsis:i=!0,sortable:o=!0,filterable:c=!1,searchable:d=!1}=n,u=r||l;return x.map((t=>{const l=f[t],n=(null==l?void 0:l.type)||"text",r={title:t,dataIndex:t,key:t,width:Math.min(12*t.length+40,a),ellipsis:i,sorter:o,render:(e,t,l)=>{const r=Fe(e,n);return u&&u.has(l)?s.jsx("span",{style:{backgroundColor:"#fff2b8",padding:"2px 4px",borderRadius:"2px"},children:r}):r}};return c&&"json"!==n&&(r.filters=function(e,t,s){if("boolean"===s)return[{text:"æ˜¯",value:"true"},{text:"å¦",value:"false"}];if("text"===s){return Array.from(new Set(e.map((e=>e[t])).filter((e=>null!=e&&""!==e)).slice(0,50))).map((e=>({text:String(e),value:String(e)})))}return[]}(e,t,n),r.onFilter=(e,s)=>{const l=s[t];return null!=l&&l.toString().includes(e)}),r}))}),[x,f,l]),j=K.useMemo((()=>t?l&&l.size>0?t.filter(((e,t)=>l.has(t))):t:[]),[t,l]),b=K.useRef(y);b.current=y,K.useEffect((()=>{if(a&&t&&t.length>0){const e=b.current(t,d,{},l);p((t=>{if(t.length!==e.length)return e;return e.some(((e,s)=>{const l=t[s];return!l||l.dataIndex!==e.dataIndex||l.title!==e.title}))?e:t}))}}),[a,t,d,l]);const C=K.useCallback((async(e,t,s)=>Promise.resolve()),[]);return{filteredDataSource:j,availableColumns:m,visibleColumns:g,sortedColumns:x,currentColumnsState:h,columnStats:f,filterConfiguration:d,setFilterConfiguration:u,generateColumns:y,exportToExcel:C,detectColumnType:e=>Ee(t,e),categorizeColumn:Me,formatValue:Fe}};function Re(e){const t=e.toLowerCase();return t.includes("name")||t.includes("å§“å")?1:t.includes("id")||t.includes("ç¼–å·")?2:t.includes("code")?3:t.includes("department")||t.includes("éƒ¨é—¨")?10:t.includes("position")||t.includes("èŒä½")?11:t.includes("phone")||t.includes("ç”µè¯")?12:t.includes("email")||t.includes("é‚®ç®±")?13:t.includes("salary")||t.includes("å·¥èµ„")?20:t.includes("date")||t.includes("æ—¶é—´")?30:100}const De={searchableFields:[],threshold:.3,debounceDelay:300,enableSuggestions:!0,maxSuggestions:5,supportExpressions:!0,caseSensitive:!1},Oe={storageKey:"universal_data_presets",enableLocalStorage:!0,enableRemoteSync:!1,maxPresets:50},Ae={filename:"data_export",format:"excel",includeHeaders:!0,timestamp:!0,creator:"Universal Data Browser",title:"Data Export",description:"Exported data from Universal Data Browser",sheetName:"Data",maxRows:1e5,compression:!0};class Te{constructor(e={}){t(this,"options"),this.options={...Ae,...e}}async exportToExcel(e,t,s,l){const n={...this.options,...l};try{if(!e||0===e.length)return void k.warning("æ²¡æœ‰æ•°æ®å¯ä»¥å¯¼å‡º");if(e.length>n.maxRows){if(!confirm(`æ•°æ®é‡è¾ƒå¤§ (${e.length} è¡Œ)ï¼Œå¯èƒ½å½±å“æ€§èƒ½ã€‚æ˜¯å¦ç»§ç»­å¯¼å‡ºï¼Ÿ`))return}const l=new ne.Workbook;l.creator=n.creator,l.created=new Date,l.modified=new Date,l.properties&&(l.properties.description=n.description);const r=l.addWorksheet(n.sheetName,{properties:{tabColor:{argb:"FF1890FF"}}}),a=this.convertProColumnsToExportColumns(t);let i=1;if(s||n.title){const e=r.addRow([s||n.title]);e.font={size:16,bold:!0},e.alignment={horizontal:"center"},r.mergeCells(1,1,1,a.length),i++,r.addRow([]),i++}if(n.timestamp){const t=[["å¯¼å‡ºæ—¶é—´",N().format("YYYY-MM-DD HH:mm:ss")],["æ•°æ®è¡Œæ•°",e.length.toString()],["å¯¼å‡ºåˆ—æ•°",a.length.toString()]];t.forEach((([e,t])=>{const s=r.addRow([e,t]);s.getCell(1).font={bold:!0},s.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F0F0"}}})),i+=t.length,r.addRow([]),i++}if(n.includeHeaders){r.addRow(a.map((e=>e.title))).eachCell(((e,t)=>{e.font={bold:!0,color:{argb:"FFFFFFFF"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF1890FF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.alignment={horizontal:"center",vertical:"middle"}})),i++}e.forEach(((e,t)=>{const s=a.map((t=>{const s=this.extractValueFromItem(e,t.dataIndex);return this.formatValueForExport(s,t.type)}));r.addRow(s).eachCell(((e,s)=>{e.border={top:{style:"thin",color:{argb:"FFE0E0E0"}},left:{style:"thin",color:{argb:"FFE0E0E0"}},bottom:{style:"thin",color:{argb:"FFE0E0E0"}},right:{style:"thin",color:{argb:"FFE0E0E0"}}},t%2==1&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFAFAFA"}});const l=a[s-1];"number"===(null==l?void 0:l.type)?e.alignment={horizontal:"right"}:"date"===(null==l?void 0:l.type)&&(e.alignment={horizontal:"center"})}))})),a.forEach(((t,s)=>{const l=s+1,n=r.getColumn(l);if(t.width)n.width=t.width/8;else{const s=t.title.length,l=Math.max(...e.slice(0,100).map((e=>{const s=this.extractValueFromItem(e,t.dataIndex);return String(s||"").length})));n.width=Math.min(Math.max(s,l)+2,50)}}));const o=n.timestamp?`_${N().format("YYYY-MM-DD_HH-mm-ss")}`:"",c=`${n.filename}${o}.xlsx`,d=await l.xlsx.writeBuffer(),u=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});se.saveAs(u,c),k.success(`æ•°æ®å¯¼å‡ºæˆåŠŸï¼š${c}`)}catch(r){throw k.error("å¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•"),r}}async exportToCSV(e,t,s,l){const n={...this.options,...l};try{if(!e||0===e.length)return void k.warning("æ²¡æœ‰æ•°æ®å¯ä»¥å¯¼å‡º");const s=this.convertProColumnsToExportColumns(t);let l="";l="\ufeff",n.includeHeaders&&(l+=s.map((e=>`"${e.title}"`)).join(",")+"\n"),e.forEach((e=>{const t=s.map((t=>{const s=this.extractValueFromItem(e,t.dataIndex),l=this.formatValueForExport(s,t.type);return`"${String(l||"").replace(/"/g,'""')}"`}));l+=t.join(",")+"\n"}));const r=n.timestamp?`_${N().format("YYYY-MM-DD_HH-mm-ss")}`:"",a=`${n.filename}${r}.csv`,i=new Blob([l],{type:"text/csv;charset=utf-8"});se.saveAs(i,a),k.success(`CSVå¯¼å‡ºæˆåŠŸï¼š${a}`)}catch(r){throw k.error("CSVå¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•"),r}}async exportToJSON(e,t,s,l){const n={...this.options,...l};try{if(!e||0===e.length)return void k.warning("æ²¡æœ‰æ•°æ®å¯ä»¥å¯¼å‡º");const l={metadata:{title:s||n.title,exportedAt:N().toISOString(),totalRows:e.length,creator:n.creator},columns:this.convertProColumnsToExportColumns(t),data:e},r=JSON.stringify(l,null,2),a=n.timestamp?`_${N().format("YYYY-MM-DD_HH-mm-ss")}`:"",i=`${n.filename}${a}.json`,o=new Blob([r],{type:"application/json"});se.saveAs(o,i),k.success(`JSONå¯¼å‡ºæˆåŠŸï¼š${i}`)}catch(r){throw k.error("JSONå¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•"),r}}convertProColumnsToExportColumns(e){return e.filter((e=>"action"!==e.key&&e.dataIndex)).map((e=>({key:e.key,title:String(e.title||e.dataIndex||e.key||""),dataIndex:e.dataIndex,width:e.width,type:this.detectColumnType(e)})))}detectColumnType(e){const t=String(e.title||"").toLowerCase(),s=String(e.dataIndex||"").toLowerCase();return t.includes("æ•°é‡")||t.includes("é‡‘é¢")||t.includes("ä»·æ ¼")||t.includes("amount")||t.includes("price")||t.includes("count")||s.includes("amount")||s.includes("price")||s.includes("count")?"number":t.includes("æ—¶é—´")||t.includes("æ—¥æœŸ")||t.includes("date")||t.includes("time")||s.includes("date")||s.includes("time")?"date":t.includes("æ˜¯å¦")||t.includes("å¯ç”¨")||t.includes("enabled")||s.includes("enabled")||s.includes("active")?"boolean":"text"}extractValueFromItem(e,t){return e?Array.isArray(t)?t.reduce(((e,t)=>null==e?void 0:e[t]),e):"string"==typeof t&&t.includes(".")?t.split(".").reduce(((e,t)=>null==e?void 0:e[t]),e):e[t]:""}formatValueForExport(e,t){if(null==e||""===e)return"";switch(t){case"number":const t=Number(e);return isNaN(t)?String(e):t.toLocaleString();case"date":try{const t=new Date(e);return isNaN(t.getTime())?String(e):N(t).format("YYYY-MM-DD HH:mm:ss")}catch{return String(e)}case"boolean":if("boolean"==typeof e)return e?"æ˜¯":"å¦";if("string"==typeof e){const t=e.toLowerCase();if(["true","yes","æ˜¯","1"].includes(t))return"æ˜¯";if(["false","no","å¦","0"].includes(t))return"å¦"}return String(e);default:return"object"==typeof e?e.$$typeof||e.$typeof?"[React Element]":JSON.stringify(e):String(e)}}setDefaultOptions(e){this.options={...this.options,...e}}getOptions(){return{...this.options}}}new Te;const Ne=({title:e,visible:t,onClose:l,dataSource:n=[],loading:r=!1,columns:a,autoGenerateColumns:i=!0,searchable:c=!0,searchConfig:d,filterable:u=!0,filterConfig:h,presetEnabled:p=!0,presetConfig:m,actions:f=[],onRowSelect:g,rowKey:x="id",selectable:y=!0,exportable:j=!0,width:b="90%",height:C=600,queryKey:v,onRowDoubleClick:S})=>{const{t:w}=le(["common"]),z=K.useRef(null),[V,E]=K.useState(!1),[F,M]=K.useState(!1),[P,R]=K.useState([]),[D,O]=K.useState(!1),A=K.useMemo((()=>n),[n]),T=K.useMemo((()=>({searchableFields:(null==d?void 0:d.searchableFields)?d.searchableFields.map((e=>e.key)):[],threshold:.3,debounceDelay:(null==d?void 0:d.debounceMs)||300,enableSuggestions:!0,maxSuggestions:5,supportExpressions:(null==d?void 0:d.supportExpressions)||!1})),[null==d?void 0:d.searchableFields,null==d?void 0:d.debounceMs,null==d?void 0:d.supportExpressions]),{query:$,results:I,isSearching:L,searchMode:Y,suggestions:B,totalResults:U,searchTime:H,search:Z,clearSearch:q,setSearchMode:J,isEmptyQuery:G,hasResults:Q,performance:X}=((e,t={})=>{const s=K.useMemo((()=>({...De,...t})),[t]),[l,n]=K.useState(""),[r,a]=K.useState(te.AUTO),[i,o]=K.useState(!1),[c,d]=K.useState([]),[u,h]=K.useState([]),[p,m]=K.useState({isOptimal:!0,duration:0,resultsCount:0,mode:te.AUTO}),[f,g]=K.useState("");K.useEffect((()=>{const e=setTimeout((()=>{g(l)}),s.debounceDelay);return()=>clearTimeout(e)}),[l,s.debounceDelay]);const x=K.useMemo((()=>{if(s.searchableFields&&s.searchableFields.length>0)return"string"==typeof s.searchableFields[0]?s.searchableFields:s.searchableFields.map((e=>e.key));if(!e||0===e.length)return[];const t=e[0],l=[];return Object.keys(t).forEach((e=>{const s=t[e];("string"==typeof s||"number"==typeof s||"object"==typeof s&&null!==s&&!Array.isArray(s))&&l.push(e)})),l}),[e,s.searchableFields]),y=K.useCallback((e=>{const t=e.match(/(\w+)\s*(>=|<=|>|<|=|!=)\s*(.+)/);if(!t)return null;const[,s,l,n]=t;return{field:s.trim(),operator:l.trim(),value:n.trim().replace(/['"]/g,"")}}),[]),j=K.useCallback(((e,t)=>{if(!t)return!1;const{field:s,operator:l,value:n}=t,r=e[s];if(null==r)return!1;const a=String(r).toLowerCase(),i=n.toLowerCase();switch(l){case"=":return a===i;case"!=":return a!==i;case">":const e=Number(r),t=Number(n);return isNaN(e)||isNaN(t)?a>i:e>t;case"<":const s=Number(r),l=Number(n);return isNaN(s)||isNaN(l)?a<i:s<l;case">=":const o=Number(r),c=Number(n);return isNaN(o)||isNaN(c)?a>=i:o>=c;case"<=":const d=Number(r),u=Number(n);return isNaN(d)||isNaN(u)?a<=i:d<=u;default:return!1}}),[]),b=K.useCallback(((e,t)=>{if(!t)return 1;if(t===e)return 1;const l=s.caseSensitive?e:e.toLowerCase(),n=s.caseSensitive?t:t.toLowerCase();let r=0,a=0,i=0;for(;a<l.length&&i<n.length;)l[a]===n[i]&&(r++,i++),a++;return i===n.length?r/n.length:0}),[s.caseSensitive]),C=K.useCallback(((t,l)=>{if(!t.trim()||!e||0===e.length)return[];const n=window.performance.now();let r=[];if(s.supportExpressions&&l!==te.FUZZY){const s=y(t);if(s){r=e.map(((e,t)=>({item:e,score:1,originalIndex:t}))).filter((({item:e})=>j(e,s))).map((({item:e,score:t})=>({item:e,score:t})));const t=window.performance.now();return m({isOptimal:!0,duration:t-n,resultsCount:r.length,mode:te.EXACT}),r}}const a=t.toLowerCase().trim().split(/\s+/);r=e.map(((e,t)=>{let n=0,r=0;const i=[];for(const o of x){const t=e[o];if(null==t)continue;const c=String(t),d=s.caseSensitive?c:c.toLowerCase();for(const e of a){let t=0;switch(l){case te.EXACT:d.includes(e)&&(t=e.length/d.length,r++);break;case te.FUZZY:const l=b(c,e);l>=s.threshold&&(t=l,r++);break;case te.REGEX:try{const l=new RegExp(e,s.caseSensitive?"g":"gi"),n=Array.from(d.matchAll(l));n.length>0&&(t=Math.min(.5*n.length,1),r++)}catch{d.includes(e)&&(t=.5,r++)}break;case te.SMART:case te.AUTO:default:if(d.includes(e))t=.8,r++;else{const l=b(c,e);l>=s.threshold&&(t=.6*l,r++)}}t>0&&i.push({key:o,value:c,indices:[[0,e.length]]}),n+=t}}return{item:e,score:r>0?n/a.length:0,matches:i.length>0?i:void 0}})).filter((e=>e.score>0)),r.sort(((e,t)=>t.score-e.score));const i=window.performance.now()-n;return m({isOptimal:i<100&&r.length<1e3,duration:i,resultsCount:r.length,mode:l}),r}),[e,x,s,y,j,b]),v=K.useCallback((t=>{if(!s.enableSuggestions||!t||!e)return[];const l=new Set,n=t.toLowerCase();return e.forEach((e=>{x.forEach((t=>{const s=e[t];if(null!=s){const e=String(s);e.toLowerCase().includes(n)&&e.length<=50&&l.add(e)}}))})),u.forEach((e=>{e.toLowerCase().includes(n)&&l.add(e)})),Array.from(l).slice(0,s.maxSuggestions).sort(((e,t)=>e.length-t.length))}),[e,x,u,s]),S=K.useMemo((()=>f.trim()?C(f,r):[]),[f,r,C]);K.useEffect((()=>{if(f.trim()){o(!0);const e=setTimeout((()=>o(!1)),50);return()=>clearTimeout(e)}o(!1)}),[f]),K.useEffect((()=>{if(l&&l.length>1){const e=v(l);d(e)}else d([])}),[l,v]);const w=K.useCallback((e=>{n(e),e.trim().length>2&&h((t=>[e,...t.filter((t=>t!==e))].slice(0,20)))}),[]),k=K.useCallback((()=>{n(""),g(""),d([])}),[]),_=!f.trim(),z=S.length>0,V=S.length,E=p.duration;return{query:l,results:S,isSearching:i,searchMode:r,suggestions:c,totalResults:V,searchTime:E,isEmptyQuery:_,hasResults:z,performance:p,search:w,clearSearch:k,setSearchMode:a,parseExpression:y,generateSuggestions:v,searchableFields:x,searchHistory:u}})(A,T),ee=K.useMemo((()=>{if(!I||0===I.length||L)return;const e=I.map((e=>A.findIndex((t=>t===e.item)))).filter((e=>-1!==e));return e.length>0?new Set(e):void 0}),[I,A,L]),se=K.useRef({data:A,searchResults:ee,searchMode:Y,filterConfig:h,autoGenerateColumns:i}),ne=K.useMemo((()=>{const e={data:A,searchResults:ee,searchMode:Y,filterConfig:h,autoGenerateColumns:i};return(se.current.data!==e.data||se.current.searchResults!==e.searchResults||se.current.searchMode!==e.searchMode||se.current.filterConfig!==e.filterConfig||se.current.autoGenerateColumns!==e.autoGenerateColumns)&&(se.current=e),se.current}),[A,ee,Y,h,i]),{filteredDataSource:re,filterConfiguration:ae,generateColumns:ie,setFilterConfiguration:oe}=Pe(ne),{presets:ce,savePreset:ue,deletePreset:he}=((e="default",t={})=>{const s={...Oe,...t},l=`${s.storageKey}_${e}`,[n,r]=K.useState([]),[a,i]=K.useState(!1),[o,c]=K.useState(null),d=K.useCallback((async()=>{try{if(i(!0),c(null),s.enableLocalStorage){const e=localStorage.getItem(l);if(e){const t=JSON.parse(e).map((e=>({id:e.id||h(),name:e.name,description:e.description||"",category:e.category||"default",isDefault:e.isDefault||!1,isFavorite:e.isFavorite||!1,isPublic:e.isPublic||!1,createdAt:e.createdAt||N().toISOString(),updatedAt:e.updatedAt||N().toISOString(),usageCount:e.usageCount||0,lastUsedAt:e.lastUsedAt,creator:e.creator||"unknown",config:e.config||{}})));r(t)}}s.enableRemoteSync}catch(e){c("Failed to load presets")}finally{i(!1)}}),[l,s]),u=K.useCallback((async e=>{try{if(s.enableLocalStorage){const t=e.slice(0,s.maxPresets);localStorage.setItem(l,JSON.stringify(t))}s.enableRemoteSync}catch(t){throw new Error("Failed to save presets")}}),[l,s]),h=K.useCallback((()=>`preset_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),[]),p=K.useCallback((async(e,t,s={})=>{try{if(i(!0),c(null),n.find((t=>t.name===e)))throw new Error(`Preset with name "${e}" already exists`);const l={id:h(),name:e,description:s.description||"",category:s.category||"default",isDefault:s.isDefault||!1,isFavorite:!1,isPublic:s.isPublic||!1,createdAt:N().toISOString(),updatedAt:N().toISOString(),usageCount:0,creator:"user",config:t};let a=[...n];return l.isDefault&&(a=a.map((e=>({...e,isDefault:!1})))),a.push(l),await u(a),r(a),l}catch(l){throw c(l instanceof Error?l.message:"Failed to save preset"),l}finally{i(!1)}}),[n,h,u]),m=K.useCallback((async e=>{try{i(!0),c(null);const t=n.map((t=>t.id===e.id?{...e,updatedAt:N().toISOString()}:t));return e.isDefault&&t.forEach((t=>{t.id!==e.id&&(t.isDefault=!1)})),await u(t),r(t),e}catch(t){throw c("Failed to update preset"),t}finally{i(!1)}}),[n,u]),f=K.useCallback((async e=>{try{if(i(!0),c(null),!n.find((t=>t.id===e)))throw new Error("Preset not found");const t=n.filter((t=>t.id!==e));await u(t),r(t)}catch(t){throw c("Failed to delete preset"),t}finally{i(!1)}}),[n,u]),g=K.useCallback((async e=>{try{const t=n.map((t=>t.id===e.id?{...t,usageCount:(t.usageCount||0)+1,lastUsedAt:N().toISOString()}:t));return await u(t),r(t),e}catch(t){}}),[n,u]),x=K.useCallback((async e=>{try{const t=n.map((t=>t.id===e?{...t,isFavorite:!t.isFavorite,updatedAt:N().toISOString()}:t));await u(t),r(t),t.find((t=>t.id===e))}catch(t){c("Failed to toggle favorite")}}),[n,u]),y=K.useCallback((e=>n.find((t=>t.id===e))),[n]),j=K.useCallback((e=>n.filter((t=>t.category===e))),[n]),b=K.useCallback((()=>n.find((e=>e.isDefault))),[n]),C=K.useCallback((async t=>{try{const s=t?n.filter((e=>t.includes(e.id))):n,l={version:"1.0",namespace:e,exportedAt:N().toISOString(),presets:s},r=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=`${e}_presets_${N().format("YYYY-MM-DD")}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}catch(s){throw new Error("Failed to export presets")}}),[n,e]),v=K.useCallback((async(e,t=!0)=>{try{i(!0),c(null);const s=await e.text(),l=JSON.parse(s);if(!l.presets||!Array.isArray(l.presets))throw new Error("Invalid preset file format");const a=l.presets.map((e=>({...e,id:h(),createdAt:N().toISOString(),updatedAt:N().toISOString(),usageCount:0,lastUsedAt:void 0})));let o;if(t){const e=new Set(n.map((e=>e.name))),t=a.map((t=>{let s=t.name,l=1;for(;e.has(s);)s=`${t.name} (${l})`,l++;return{...t,name:s}}));o=[...n,...t]}else o=a;await u(o),r(o),k.success(`Successfully imported ${a.length} presets`)}catch(s){throw c("Failed to import presets"),k.error("Failed to import presets"),s}finally{i(!1)}}),[n,h,u]);return K.useEffect((()=>{d()}),[d]),{presets:n,loading:a,error:o,savePreset:p,updatePreset:m,deletePreset:f,applyPreset:g,toggleFavorite:x,getPreset:y,getPresetsByCategory:j,getDefaultPreset:b,exportPresets:C,importPresets:v,loadPresets:d,generatePresetId:h}})(v||"universal"),me=K.useRef([]),fe=K.useRef({columns:void 0,hasData:!1,actionsLength:0,autoGen:!1,filterConfig:void 0}),ge=K.useMemo((()=>{const e=re&&re.length>0,t={columns:a,hasData:e,actionsLength:f.length,autoGen:i,filterConfig:ae};if(!(fe.current.columns!==t.columns||fe.current.hasData!==t.hasData||fe.current.actionsLength!==t.actionsLength||fe.current.autoGen!==t.autoGen||fe.current.filterConfig!==t.filterConfig)&&me.current.length>0)return me.current;if(!e){const e=a||[];return me.current=e,fe.current=t,e}const l=[...a&&a.length>0?a:i?ie(re,ae):[]];return f.length>0&&l.push({title:w("table.action"),key:"action",fixed:"right",width:Math.min(120+30*f.length,200),render:(e,t)=>s.jsx("div",{style:{display:"flex",gap:4},children:f.map((e=>s.jsx("button",{onClick:()=>e.onClick(t),style:{border:"none",background:"transparent",cursor:"pointer",padding:4,borderRadius:4},title:e.label,children:e.icon},e.key)))})}),me.current=l,fe.current=t,l}),[a,re,ae,ie,f,i,w]),xe=K.useCallback((async()=>{if(j&&0!==re.length){O(!0);try{const t=new Te;await t.exportToExcel(re,ge,e,{timestamp:!0,creator:"Universal Data Modal"})}catch(t){k.error(w("table.export_failed"))}finally{O(!1)}}else k.warning(w("table.no_data_to_export"))}),[j,re,ge,e,w]),ye=K.useCallback((async t=>{if(0!==t.length){O(!0);try{const s=new Te;await s.exportToExcel(t,ge,`${e} - ${w("table.selected_rows")}`,{timestamp:!0,creator:"Universal Data Modal"})}catch(s){k.error(w("table.export_failed"))}finally{O(!1)}}else k.warning(w("table.select_rows_first"))}),[ge,e,w]),be=K.useCallback((e=>{e.filterConfig&&oe(e.filterConfig),e.searchQuery&&Z(e.searchQuery),e.searchMode&&J(e.searchMode),k.success(`${w("preset.applied")}: ${e.name}`)}),[oe,Z,J,w]),Ce=K.useCallback(((t,s)=>{const l={filterConfig:ae,searchQuery:$||void 0,searchMode:Y||te.AUTO,tableState:{pagination:{current:1,pageSize:20}}};ue(t,l,{description:s,category:e}),k.success(`${w("preset.saved")}: ${t}`)}),[ae,$,Y,ue,e,w]),ve=K.useMemo((()=>{if(y)return{type:"checkbox",selectedRowKeys:P.map((e=>"function"==typeof x?x(e):e[x])),onChange:(e,t)=>{R(t),null==g||g(t)}}}),[y,P,x,g]);return s.jsx(_,{title:e,open:t,onCancel:l,width:"string"==typeof b?b:Math.min(b||1200,.95*window.innerWidth),style:{top:20,maxWidth:"95vw",margin:"0 auto"},footer:null,destroyOnClose:!0,className:`universal-data-modal ${de.universalDataModal||""}`,styles:{body:{padding:"16px 24px 24px 24px",maxHeight:"80vh",overflowY:"auto"}},children:s.jsxs("div",{children:[c&&s.jsx("div",{className:de.searchPanelContainer,style:{marginBottom:"16px"},children:s.jsx(pe,{searchQuery:$,searchResults:I,isSearching:L,searchMode:Y,suggestions:B,totalResults:U,searchTime:H,isEmptyQuery:G,hasResults:Q,performance:X,onSearch:Z,onClear:q,onSearchModeChange:J,placeholder:(null==d?void 0:d.placeholder)||w("table.search_placeholder"),showPerformance:!0,searchModes:null==d?void 0:d.searchModes})}),u&&s.jsx(je,{visible:V,onClose:()=>E(!1),filterConfig:ae,onFilterConfigChange:oe,dataSource:A,columns:ge}),s.jsx("div",{className:de.tableContainer,style:{marginTop:c?"0":"16px"},children:s.jsx(W,{actionRef:z,columns:ge,dataSource:re,rowKey:x,loading:r,size:"small",scroll:{x:"max-content",y:Math.min(C||400,.5*window.innerHeight)},search:!1,pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} ${w("table.of")} ${e} ${w("table.items")}`,pageSizeOptions:["10","20","50","100"],defaultPageSize:20},toolbar:{style:{padding:"12px 0",marginBottom:"8px",borderBottom:"1px solid #f0f0f0"},actions:[...j?[s.jsx(o,{onClick:xe,loading:D,style:{marginRight:"8px"},children:w("table.export")},"export")]:[],...u?[s.jsx(o,{onClick:()=>E(!0),style:{marginRight:"8px"},children:w("table.filter")},"filter")]:[],...p?[s.jsx(o,{onClick:()=>M(!0),style:{marginRight:"8px"},children:w("table.presets")},"presets")]:[]]},rowSelection:ve,onRow:e=>({onDoubleClick:()=>null==S?void 0:S(e)}),tableAlertRender:({selectedRowKeys:e})=>s.jsx("span",{children:w("table.selected_count",{count:e.length})}),tableAlertOptionRender:({onCleanSelected:e})=>s.jsxs("div",{style:{display:"flex",gap:8},children:[j&&s.jsx("button",{onClick:()=>ye(P),children:w("table.export_selected")}),s.jsx("button",{onClick:e,children:w("table.clear_selection")})]}),options:{reload:()=>{},density:!0,fullScreen:!0,setting:{draggable:!0,checkable:!0,listsHeight:500}}})}),p&&s.jsx(_e,{visible:F,onClose:()=>M(!1),currentConfig:{filterConfig:ae,searchQuery:$,searchMode:Y},presets:ce,onApplyPreset:be,onSavePreset:Ce,onDeletePreset:he,categories:null==m?void 0:m.categories})]})})};const $e=()=>{const{t:e}=le(["employee","common"]),t=X();ee({componentName:"EmployeeListPageUniversal",warningThreshold:3,enableLogging:!0,enableProfiling:!0});const[a,c]=K.useState(!1),d=K.useMemo((()=>({page:1,size:100,sortBy:"created_at",sortOrder:"desc"})),[]),{permissions:u}=oe(),{data:h=[],isLoading:m}=function(e,t,s){const l={all:[n=e],lists:()=>[n,"list"],list:e=>[n,"list",e],details:()=>[n,"detail"],detail:e=>[n,"detail",e]};var n;const r={enabled:!0,staleTime:3e4,gcTime:3e5,cacheTime:3e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always",...s},a=ie({queryKey:l.all,queryFn:async()=>{performance.now();try{const e=await t();return performance.now(),Array.isArray(e)?e.map(((e,t)=>{if("object"!=typeof e||null===e)return e;const s={...e},l=s;return Object.keys(l).forEach((e=>{const t=l[e];"object"==typeof t&&null!==t?(t.$$typeof||t.$typeof||t.type&&t.props)&&(l[e]="[React Element Removed]"):"function"==typeof t&&(l[e]="[Function Removed]")})),s})):[]}catch(e){throw e}},...r});return{...a,refetch:async()=>a.refetch(),invalidate:()=>{a.refetch()}}}("employees_universal",(()=>ce.getEmployeesFromView(d)),{enabled:!0,staleTime:3e4,gcTime:3e5}),f=K.useMemo((()=>{if(!h||0===h.length)return{total:0,active:0,departments:0,recentHires:0};let e=0,t=0;const s=new Set,l=new Date;return l.setDate(l.getDate()-30),h.forEach((n=>{if("active"===n.employee_status&&e++,n.department_name&&s.add(n.department_name),n.hire_date){let e;e="string"==typeof n.hire_date||"number"==typeof n.hire_date?new Date(n.hire_date):new Date(n.hire_date.toString()),e>l&&t++}})),{total:h.length,active:e,departments:s.size,recentHires:t}}),[h]),g=K.useMemo((()=>({searchableFields:[{key:"full_name",label:"å§“å",type:"text"},{key:"employee_code",label:"å‘˜å·¥ç¼–å·",type:"text"},{key:"department_name",label:"éƒ¨é—¨",type:"text"},{key:"position_name",label:"èŒä½",type:"text"},{key:"phone_number",label:"ç”µè¯",type:"text"},{key:"email",label:"é‚®ç®±",type:"text"}],supportExpressions:!0,searchModes:[te.AUTO,te.EXACT,te.FUZZY,te.SMART],placeholder:"æœç´¢å‘˜å·¥å§“åã€ç¼–å·ã€éƒ¨é—¨ã€èŒä½... æˆ–ä½¿ç”¨è¡¨è¾¾å¼å¦‚ department_name=æŠ€æœ¯éƒ¨",debounceMs:300})),[]),x=K.useMemo((()=>({hideEmptyColumns:!0,hideZeroColumns:!1,categorySort:["åŸºæœ¬ä¿¡æ¯","è”ç³»ä¿¡æ¯","èŒä½ä¿¡æ¯","å…¶ä»–ä¿¡æ¯"],presets:[{name:"åŸºæœ¬ä¿¡æ¯",filters:{employee_status_equals:"active"},description:"æ˜¾ç¤ºåœ¨èŒå‘˜å·¥çš„åŸºæœ¬ä¿¡æ¯"},{name:"è”ç³»æ–¹å¼",filters:{},description:"æ˜¾ç¤ºå‘˜å·¥è”ç³»æ–¹å¼"},{name:"èŒä½ä¿¡æ¯",filters:{},description:"æ˜¾ç¤ºèŒä½å’Œéƒ¨é—¨ä¿¡æ¯"},{name:"æœ€è¿‘å…¥èŒ",filters:{},description:"æ˜¾ç¤ºæœ€è¿‘30å¤©å…¥èŒçš„å‘˜å·¥"}]})),[]),y=K.useMemo((()=>({enabled:!0,categories:["å‘˜å·¥ç­›é€‰","éƒ¨é—¨è§†å›¾","çŠ¶æ€ç­›é€‰","è‡ªå®šä¹‰é…ç½®"]})),[]),j=K.useMemo((()=>[{key:"view",label:"æŸ¥çœ‹è¯¦æƒ…",icon:s.jsx(P,{}),onClick:e=>{t(`/hr/employees/${e.id}/detail`)},permission:"canViewDetail"},{key:"edit",label:"ç¼–è¾‘",icon:s.jsx(D,{}),onClick:e=>{t(`/hr/employees/${e.id}/edit`)},permission:"canUpdate"},{key:"delete",label:"åˆ é™¤",icon:s.jsx(A,{}),onClick:e=>{},permission:"canDelete"}].filter((e=>!e.permission||u[e.permission]))),[t,u]),b=K.useCallback((e=>{}),[]),C=K.useCallback((e=>{}),[]),v=K.useCallback((e=>{t(`/hr/employees/${e.id}/detail`)}),[t]),S=s.jsxs(i,{children:[s.jsx(o,{type:"primary",icon:s.jsx(p,{}),onClick:()=>c(!0),size:"large",children:"é«˜çº§æœç´¢æµè§ˆ"}),u.canCreate&&s.jsx(o,{type:"primary",icon:s.jsx(F,{}),onClick:()=>t("/hr/employees/create"),size:"large",children:"æ–°å¢žå‘˜å·¥"}),u.canExport&&s.jsx(o,{icon:s.jsx(Z,{}),onClick:()=>c(!0),size:"large",children:"æ‰¹é‡å¯¼å‡º"})]});return s.jsxs(re,{title:"å‘˜å·¥ç®¡ç†",subtitle:"çŽ°ä»£åŒ–å‘˜å·¥ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ - åŸºäºŽé€šç”¨æ•°æ®æµè§ˆç»„ä»¶",showBreadcrumb:!0,breadcrumbItems:[{title:"é¦–é¡µ",href:"/"},{title:"äººåŠ›èµ„æº",href:"/hr"},{title:"å‘˜å·¥ç®¡ç†"}],headerExtra:S,children:[s.jsxs(n,{gutter:[16,16],style:{marginBottom:24},children:[s.jsx(r,{span:6,children:s.jsx(ae,{children:s.jsx(q,{title:"å‘˜å·¥æ€»æ•°",value:f.total,prefix:s.jsx(I,{style:{color:"#1890ff"}}),valueStyle:{color:"#1890ff"}})})}),s.jsx(r,{span:6,children:s.jsx(ae,{children:s.jsx(q,{title:"åœ¨èŒå‘˜å·¥",value:f.active,prefix:s.jsx(I,{style:{color:"#52c41a"}}),valueStyle:{color:"#52c41a"}})})}),s.jsx(r,{span:6,children:s.jsx(ae,{children:s.jsx(q,{title:"éƒ¨é—¨æ•°é‡",value:f.departments,prefix:s.jsx(J,{style:{color:"#722ed1"}}),valueStyle:{color:"#722ed1"}})})}),s.jsx(r,{span:6,children:s.jsx(ae,{children:s.jsx(q,{title:"æœ€è¿‘å…¥èŒ",value:f.recentHires,prefix:s.jsx(I,{style:{color:"#fa8c16"}}),valueStyle:{color:"#fa8c16"},suffix:"äºº"})})})]}),s.jsxs(ae,{title:"å‘˜å·¥æ¦‚è§ˆ",extra:s.jsx(i,{children:s.jsx(o,{type:"link",onClick:()=>c(!0),icon:s.jsx(p,{}),children:"è¯¦ç»†æµè§ˆ"})}),children:[s.jsxs(n,{gutter:[16,16],children:[s.jsx(r,{span:8,children:s.jsxs(l,{size:"small",styles:{body:{textAlign:"center",padding:"16px"}},children:[s.jsx(I,{style:{fontSize:32,color:"#1890ff",marginBottom:8}}),s.jsxs("div",{children:[s.jsxs("div",{style:{fontSize:16,fontWeight:"bold"},children:[h.slice(0,5).map((e=>e.full_name)).join("ã€"),h.length>5&&"..."]}),s.jsxs("div",{style:{color:"#666",fontSize:12},children:["æœ€æ–°å‘˜å·¥ (",h.length>5?"ä»…æ˜¾ç¤ºå‰5ä½":"å…¨éƒ¨",")"]})]})]})}),s.jsx(r,{span:8,children:s.jsxs(l,{size:"small",styles:{body:{textAlign:"center",padding:"16px"}},children:[s.jsx(J,{style:{fontSize:32,color:"#52c41a",marginBottom:8}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:16,fontWeight:"bold"},children:Array.from(new Set(h.map((e=>e.department_name)).filter(Boolean))).slice(0,3).join("ã€")}),s.jsxs("div",{style:{color:"#666",fontSize:12},children:["ä¸»è¦éƒ¨é—¨ (å…±",f.departments,"ä¸ª)"]})]})]})}),s.jsx(r,{span:8,children:s.jsxs(l,{size:"small",styles:{body:{textAlign:"center",padding:"16px"}},children:[s.jsx(G,{style:{fontSize:32,color:"#fa8c16",marginBottom:8}}),s.jsxs("div",{children:[s.jsxs("div",{style:{fontSize:16,fontWeight:"bold"},children:[h.filter((e=>e.phone_number)).length," / ",h.length]}),s.jsx("div",{style:{color:"#666",fontSize:12},children:"è”ç³»æ–¹å¼å®Œæ•´åº¦"})]})]})})]}),s.jsx("div",{style:{marginTop:16,padding:16,backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:6,textAlign:"center"},children:s.jsxs(i,{direction:"vertical",children:[s.jsx("div",{style:{color:"#52c41a",fontWeight:"bold"},children:"ðŸŽ‰ ä½¿ç”¨å…¨æ–°çš„é€šç”¨æ•°æ®æµè§ˆç³»ç»Ÿ"}),s.jsx("div",{style:{color:"#666",fontSize:12},children:'ç‚¹å‡»"é«˜çº§æœç´¢æµè§ˆ"ä½“éªŒå¼ºå¤§çš„æœç´¢ã€ç­›é€‰ã€åˆ—ç®¡ç†å’Œé¢„è®¾åŠŸèƒ½'})]})})]}),s.jsx(Ne,{title:"å‘˜å·¥ä¿¡æ¯æµè§ˆ",visible:a,onClose:()=>c(!1),dataSource:h,loading:m,searchable:!0,searchConfig:g,filterable:!0,filterConfig:x,presetEnabled:!0,presetConfig:y,actions:j,onRowSelect:b,onExport:C,onRowDoubleClick:v,rowKey:"id",selectable:!0,exportable:u.canExport,width:"95%",height:650,queryKey:"employees_modal"})]})};export{$e as default};
