import{b as e}from"./react-vendor-D9vUlElp.js";import{e as a}from"./hr-management-D97vxp0y.js";import{u as t}from"./i18n-vendor-DF0Yg0Xi.js";import{s}from"./antd-vendor-DWzn6iQK.js";const r={current:1,pageSize:20,total:0},l={},o={},c=()=>{const{t:c}=t(["employeeManagement","common"]),[n,m]=e.useState([]),[u,i]=e.useState(!1),[d,p]=e.useState(null),[y,g]=e.useState(r),[h,f]=e.useState(l),[b,w]=e.useState(o),E=e.useCallback((async()=>{i(!0),p(null);try{const e={page:y.current,size:y.pageSize,sortBy:b.field,sortOrder:"ascend"===b.order?"asc":"descend"===b.order?"desc":void 0,...h},t=await a.getEmployees(e);t&&t.data?(m(t.data),g((e=>{var a;return{...e,total:(null==(a=t.meta)?void 0:a.total)||0}}))):(m([]),g((e=>({...e,total:0}))))}catch(e){const a=(null==e?void 0:e.message)||c("common:message.fetch_failed");p(a),s.error(a),m([]),g((e=>({...e,total:0})))}finally{i(!1)}}),[y.current,y.pageSize,b,h,c]),v=e.useCallback((async e=>{try{const t=await a.createEmployee(e);return s.success(c("employeeManagement:message.create_success")),await E(),t}catch(t){const e=(null==t?void 0:t.message)||c("employeeManagement:message.create_failed");throw s.error(e),t}}),[E,c]),_=e.useCallback((async(e,t)=>{try{const r=await a.updateEmployee(e,t);return s.success(c("employeeManagement:message.update_success")),await E(),r}catch(r){const e=(null==r?void 0:r.message)||c("employeeManagement:message.update_failed");throw s.error(e),r}}),[E,c]),S=e.useCallback((async e=>{try{await a.deleteEmployee(e),s.success(c("employeeManagement:message.delete_success")),await E()}catch(t){const e=(null==t?void 0:t.message)||c("employeeManagement:message.delete_failed");throw s.error(e),t}}),[E,c]),M=e.useCallback((async e=>{try{await a.batchDeleteEmployees(e),s.success(c("employeeManagement:message.batch_delete_success",{count:e.length})),await E()}catch(t){const e=(null==t?void 0:t.message)||c("employeeManagement:message.batch_delete_failed");throw s.error(e),t}}),[E,c]),k=e.useCallback((()=>{E()}),[E]),C=e.useCallback((e=>{f((a=>({...a,...e}))),g((e=>({...e,current:1})))}),[]),j=e.useCallback((()=>{f(l),w(o),g(r)}),[]);return e.useEffect((()=>{E()}),[E]),{employees:n,loading:u,error:d,pagination:y,setPagination:g,filters:h,setFilters:f,sorter:b,setSorter:w,fetchEmployees:E,createEmployee:v,updateEmployee:_,deleteEmployee:S,batchDeleteEmployees:M,refreshEmployees:k,searchEmployees:C,resetFilters:j}};export{c as u};
