import{s as e,j as s,n as t,m as o,S as l,B as a,ba as r,e as n,F as i,a0 as m,_ as c,cA as d,cm as p,v as y,r as h,t as x,b2 as j,T as u,H as f,J as g,bn as b,q as v,o as N,Z as k}from"./antd-vendor-C1V4cVms.js";import{k as S,u as E,b as w}from"./react-vendor-D9vUlElp.js";import{M as C,a as I}from"./index-CNoCQzrU.js";import{e as z}from"./employee-service-EoGCXWnj.js";import{f as $,g as _}from"./hr-management-Bxz25n3J.js";import{u as B}from"./useRenderCount-CIqEsBom.js";import{u as M}from"./i18n-vendor-DF0Yg0Xi.js";import"./state-vendor-BIBp6L7x.js";import"./admin-management-B_B4TQCC.js";import"./payroll-management-BhhUn9Iu.js";import"./utils-vendor-CFhz7Dje.js";const D=({title:e})=>s.jsx("div",{className:"p-6 text-center",children:s.jsxs("p",{className:"typography-body text-secondary",children:[e," 内容将在此处显示"]})}),{Title:F,Text:H}=u,T=()=>{var u,T;const{t:Y}=M(["employee","common","hr"]),{employeeId:L}=S(),V=E(),[W,q]=w.useState(null),[A,J]=w.useState(!0),[K,P]=w.useState(null),[R,U]=w.useState("basic"),{lookupMaps:Z,loading:G}=$(),{permissions:O}=_(),{renderCount:Q,isExcessive:X}=B({componentName:"EmployeeDetailPageModern",warningThreshold:5,enableLogging:!0});w.useEffect((()=>{(async()=>{if(!L)return P(Y("employee:invalidEmployeeId")),void J(!1);try{J(!0),P(null);const e=await z.getEmployeeByIdFromView(L);q(e)}catch(s){P(Y("employee:fetchError")),e.error(Y("employee:fetchError"))}finally{J(!1)}})()}),[L,Y]);const ee=w.useCallback((async()=>{if(L)try{J(!0),P(null);const e=await z.getEmployeeByIdFromView(L);q(e)}catch(s){P(Y("employee:fetchError")),e.error(Y("employee:fetchError"))}finally{J(!1)}}),[L,Y]),se=e=>{if(!e)return Y("employee:unknownEmployee");const s=[e.last_name,e.first_name].filter(Boolean);return s.length>0?s.join(""):e.employee_code||Y("employee:unknownEmployee")},te=w.useCallback((()=>{W&&V(`/hr/employees/${W.id}/edit`)}),[W,V]),oe=w.useCallback((()=>{V("/hr/employees")}),[V]);if(A||G)return s.jsx(C,{title:Y("employee:employeeDetail"),subtitle:Y("employee:loading"),children:s.jsx("div",{className:"loading-container d-flex justify-center items-center",style:{height:"400px"},children:s.jsx(t,{size:"large"})})});if(K||!W)return s.jsx(C,{title:Y("employee:employeeDetail"),subtitle:Y("employee:employeeNotFound"),children:s.jsx(I,{children:s.jsx(o,{message:Y("employee:error"),description:K||Y("employee:employeeNotFound"),type:"error",showIcon:!0,action:s.jsxs(l,{children:[s.jsx(a,{size:"small",onClick:oe,children:Y("common:back")}),s.jsx(a,{size:"small",type:"primary",onClick:ee,children:Y("common:retry")})]})})})});const le=s.jsxs(l,{children:[s.jsx(a,{icon:s.jsx(r,{}),onClick:oe,className:"modern-button variant-ghost",children:Y("common:back")}),O.canUpdate&&s.jsx(a,{type:"primary",icon:s.jsx(n,{}),onClick:te,className:"modern-button variant-primary",children:Y("common:edit")})]}),ae=[{title:Y("common:home"),href:"/"},{title:Y("common:hrManagement"),href:"/hr"},{title:Y("employee:employeeManagement"),href:"/hr/employees"},{title:se(W)}],re=[{key:"basic",label:s.jsxs(l,{children:[s.jsx(i,{}),Y("employee:basicInfo")]}),children:s.jsx(D,{title:Y("employee:basicInfo")})},{key:"job",label:s.jsxs(l,{children:[s.jsx(m,{}),Y("employee:jobInfo")]}),children:s.jsx(D,{title:Y("employee:jobInfo")})},{key:"compensation",label:s.jsxs(l,{children:[s.jsx(c,{}),Y("employee:compensationHistory")]}),children:s.jsx(D,{title:Y("employee:compensationHistory")})},{key:"contract",label:s.jsxs(l,{children:[s.jsx(d,{}),Y("employee:contractInfo")]}),children:s.jsx(D,{title:Y("employee:contractInfo")})},{key:"history",label:s.jsxs(l,{children:[s.jsx(p,{}),Y("employee:jobHistory")]}),children:s.jsx(D,{title:Y("employee:jobHistory")})},{key:"leave",label:s.jsxs(l,{children:[s.jsx(y,{}),Y("employee:leaveBalance")]}),children:s.jsx(D,{title:Y("employee:leaveBalance")})}];return s.jsxs(C,{title:se(W),subtitle:`${Y("employee:employeeCode")}: ${W.employee_code||Y("common:notSet")}`,headerExtra:le,showBreadcrumb:!0,breadcrumbItems:ae,children:[s.jsx(I,{className:"mb-6",children:s.jsxs(h,{gutter:[24,24],align:"middle",children:[s.jsx(x,{xs:24,sm:12,md:8,children:s.jsxs("div",{className:"d-flex items-center gap-4",children:[s.jsx(j,{size:80,icon:s.jsx(i,{}),className:"shadow-md",style:{backgroundColor:"#3b82f6",fontSize:"32px"}}),s.jsxs("div",{children:[s.jsx(F,{level:3,className:"typography-heading-2 mb-1",children:se(W)}),s.jsxs(l,{direction:"vertical",size:"small",children:[(e=>{const t=e.toLowerCase();let o="default";return t.includes("active")||t.includes("在职")?o="success":t.includes("probation")||t.includes("试用")?o="warning":(t.includes("terminated")||t.includes("离职"))&&(o="error"),s.jsx(N,{color:o,className:"typography-caption-strong",children:e})})(W.employee_status||"在职"),s.jsx(H,{className:"typography-caption text-secondary",children:W.department_name||W.departmentName||Y("common:notSet")})]})]})]})}),s.jsx(x,{xs:24,sm:12,md:8,children:s.jsxs(h,{gutter:16,children:[s.jsx(x,{span:12,children:s.jsx(f,{title:Y("employee:seniority"),value:(e=>{if(!e)return Y("common:notSet");try{const s=k(e),t=k(),o=t.diff(s,"year"),l=t.diff(s.add(o,"year"),"month");return o>0?`${o}${Y("common:years")}${l}${Y("common:months")}`:`${l}${Y("common:months")}`}catch{return Y("common:calculateError")}})(null==(u=W.hire_date)?void 0:u.toString()),prefix:s.jsx(y,{}),valueStyle:{fontSize:"18px",fontWeight:"600",color:"#059669"}})}),s.jsx(x,{span:12,children:s.jsx(f,{title:Y("employee:position"),value:W.position_name||Y("common:notSet"),prefix:s.jsx(g,{}),valueStyle:{fontSize:"14px",fontWeight:"500",color:"#3b82f6"}})})]})}),s.jsx(x,{xs:24,sm:24,md:8,children:s.jsx("div",{className:"text-right",children:s.jsxs(l,{direction:"vertical",size:"small",className:"w-full",children:[W.email&&s.jsxs("div",{className:"d-flex items-center gap-2 justify-end",children:[s.jsx(b,{className:"text-accent"}),s.jsx(H,{className:"typography-body",children:s.jsx("a",{href:`mailto:${W.email}`,className:"text-accent",children:W.email})})]}),s.jsxs("div",{className:"d-flex items-center gap-2 justify-end",children:[s.jsx(y,{className:"text-tertiary"}),s.jsxs(H,{className:"typography-caption",children:[Y("employee:hireDate"),": ",(e=>{if(!e)return Y("common:notSet");try{return k(e).format("YYYY-MM-DD")}catch{return Y("common:formatError")}})(null==(T=W.hire_date)?void 0:T.toString())]})]})]})})})]})}),s.jsx(I,{children:s.jsx(v,{activeKey:R,onChange:U,items:re,className:"modern-tabs",size:"large"})})]})};export{T as default};
