---
description:
globs:
alwaysApply: false
---
# i18n ç¿»è¯‘ç¼ºå¤±æŠ¥é”™æœ€ä¼˜åŒ–å¤„ç†æµç¨‹

## ğŸ“‹ æ¦‚è¿°

æœ¬è§„åˆ™å®šä¹‰äº†å¤„ç† i18n ç¿»è¯‘ç¼ºå¤±æŠ¥é”™çš„æ ‡å‡†åŒ–æœ€ä¼˜æµç¨‹ï¼Œç¡®ä¿å¿«é€Ÿã€å‡†ç¡®åœ°å®šä½å’Œä¿®å¤ç¿»è¯‘é—®é¢˜ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

## ğŸ¯ é€‚ç”¨åœºæ™¯

- ğŸ’» å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°ç¿»è¯‘ key ç¼ºå¤±
- ğŸ” æµè§ˆå™¨æ§åˆ¶å°å‡ºç° i18n ç›¸å…³é”™è¯¯
- ğŸ“ ä»£ç å®¡æŸ¥æ—¶å‘ç°ç¡¬ç¼–ç æ–‡æœ¬
- ğŸš€ éƒ¨ç½²å‰çš„ç¿»è¯‘å®Œæ•´æ€§æ£€æŸ¥

## âš¡ å¿«é€Ÿå¤„ç†æµç¨‹

### 1. é”™è¯¯è¯†åˆ«ä¸åˆ†ç±»

**ğŸ” å¸¸è§é”™è¯¯æ¨¡å¼:**
```javascript
// æ§åˆ¶å°é”™è¯¯ç¤ºä¾‹
i18next::translator: missingKey zh-CN common buttons.save
i18next::translator: missingKey en common buttons.save
```

**ğŸ“Š é”™è¯¯åˆ†ç±»ä¼˜å…ˆçº§:**
- ğŸ”´ **P0 - å…³é”®è·¯å¾„**: ç™»å½•ã€ä¸»è¦ä¸šåŠ¡æµç¨‹é¡µé¢
- ğŸŸ  **P1 - é‡è¦åŠŸèƒ½**: æ•°æ®å½•å…¥ã€æŠ¥è¡¨æŸ¥çœ‹é¡µé¢  
- ğŸŸ¡ **P2 - ä¸€èˆ¬åŠŸèƒ½**: è®¾ç½®é¡µé¢ã€å¸®åŠ©æ–‡æ¡£
- ğŸŸ¢ **P3 - è¾¹ç¼˜åœºæ™¯**: é”™è¯¯é¡µé¢ã€è°ƒè¯•å·¥å…·

### 2. è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·é“¾

**ğŸ› ï¸ å·¥å…·æ‰§è¡Œé¡ºåº:**

```bash
# 1. æå–æ‰€æœ‰ç¿»è¯‘ key (åœ¨ frontend/v2 ç›®å½•ä¸‹æ‰§è¡Œ)
npm run i18n:scan

# 2. æ£€æŸ¥ç¿»è¯‘æ–‡ä»¶å®Œæ•´æ€§
npm run build 2>&1 | grep -i "i18n\|translation\|missing"

# 3. ä½¿ç”¨ i18next-parser åˆ†æç¼ºå¤± key
npx i18next-parser --config i18next-parser.config.cjs --verbose
```

**ğŸ“ å…³é”®é…ç½®æ–‡ä»¶:**
- [i18next-parser.config.cjs](mdc:frontend/v2/i18next-parser.config.cjs)
- [i18n.ts](mdc:frontend/v2/src/i18n.ts)
- [I18N_GUIDELINES.md](mdc:frontend/v2/I18N_GUIDELINES.md)

### 3. æ‰¹é‡ä¿®å¤ç­–ç•¥

**ğŸ¯ ä¿®å¤ä¼˜å…ˆçº§ç­–ç•¥:**

1. **æ”¶é›†é˜¶æ®µ** - ç³»ç»Ÿæ€§æ”¶é›†æ‰€æœ‰é”™è¯¯
   ```bash
   # ä½¿ç”¨ Playwright è‡ªåŠ¨åŒ–æµè§ˆæ”¶é›†é”™è¯¯
   # å‚è€ƒ: i18n_errors_collection.md
   ```

2. **åˆ†æé˜¶æ®µ** - æŒ‰å‘½åç©ºé—´å’Œä¼˜å…ˆçº§åˆ†ç»„
   ```javascript
   // æŒ‰å‘½åç©ºé—´åˆ†ç»„ç¼ºå¤±çš„ key
   const missingKeys = {
     'common': ['buttons.save', 'labels.name'],
     'payroll': ['status.pending', 'actions.calculate'],
     'employee': ['fields.position', 'tabs.personal']
   };
   ```

3. **ä¿®å¤é˜¶æ®µ** - æ‰¹é‡æ·»åŠ ç¿»è¯‘
   ```json
   // ç¤ºä¾‹: public/locales/zh-CN/common.json
   {
     "buttons": {
       "save": "ä¿å­˜",
       "cancel": "å–æ¶ˆ",
       "confirm": "ç¡®è®¤"
     },
     "labels": {
       "name": "å§“å",
       "status": "çŠ¶æ€"
     }
   }
   ```

### 4. ä»£ç å±‚é¢æœ€ä½³å®è·µ

**âœ… æ¨èå†™æ³•:**
```typescript
// 1. é™æ€ keyï¼Œä¾¿äºå·¥å…·æå–
const { t } = useTranslation(['payroll', 'common']);
const title = t('payroll:page_title'); // æ˜ç¡®å‘½åç©ºé—´

// 2. åµŒå¥—ç»“æ„è®¿é—®
const buttonText = t('buttons.save'); // å¯¹åº” JSON ä¸­ buttons.save

// 3. å¸¦é»˜è®¤å€¼çš„å®‰å…¨è°ƒç”¨
const label = t('employee.fields.position', { defaultValue: 'èŒä½' });
```

**âŒ é¿å…å†™æ³•:**
```typescript
// 1. åŠ¨æ€æ‹¼æ¥ keyï¼ˆå·¥å…·éš¾ä»¥æå–ï¼‰
const key = 'buttons.' + action; // ä¸æ¨è
const text = t(key);

// 2. ç¡¬ç¼–ç æ–‡æœ¬
const title = 'è–ªèµ„ç®¡ç†'; // åº”è¯¥ä½¿ç”¨ t('payroll:page_title')

// 3. æ‰å¹³åŒ– key
const text = t('buttons_save'); // åº”è¯¥ä½¿ç”¨ buttons.save
```

### 5. éªŒè¯ä¸æµ‹è¯•æµç¨‹

**ğŸ§ª éªŒè¯æ­¥éª¤:**

1. **ç¼–è¯‘æ—¶æ£€æŸ¥**
   ```bash
   cd frontend/v2
   npm run build # æ£€æŸ¥ TypeScript ç¼–è¯‘é”™è¯¯
   ```

2. **è¿è¡Œæ—¶æ£€æŸ¥**
   ```bash
   npm run dev # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
   # è®¿é—®ç›¸å…³é¡µé¢ï¼Œæ£€æŸ¥æ§åˆ¶å°æ˜¯å¦è¿˜æœ‰ i18n é”™è¯¯
   ```

3. **è‡ªåŠ¨åŒ–æµ‹è¯•**
   ```bash
   # ä½¿ç”¨ Playwright è‡ªåŠ¨åŒ–æ£€æŸ¥æ‰€æœ‰é¡µé¢
   # ç¡®ä¿æ²¡æœ‰ç¿»è¯‘ç¼ºå¤±é”™è¯¯
   ```

## ğŸ“‚ æ–‡ä»¶ç»„ç»‡è§„èŒƒ

**ğŸ—‚ï¸ ç¿»è¯‘æ–‡ä»¶ç»“æ„:**
```
frontend/v2/public/locales/
â”œâ”€â”€ zh-CN/
â”‚   â”œâ”€â”€ common.json      # é€šç”¨ç¿»è¯‘
â”‚   â”œâ”€â”€ payroll.json     # è–ªèµ„æ¨¡å—
â”‚   â”œâ”€â”€ employee.json    # å‘˜å·¥æ¨¡å—
â”‚   â””â”€â”€ admin.json       # ç®¡ç†æ¨¡å—
â””â”€â”€ en/
    â”œâ”€â”€ common.json
    â”œâ”€â”€ payroll.json
    â”œâ”€â”€ employee.json
    â””â”€â”€ admin.json
```

**ğŸ”¤ å‘½åç©ºé—´çº¦å®š:**
- `common`: å…¨å±€å…±äº«çš„æŒ‰é’®ã€æ ‡ç­¾ã€çŠ¶æ€
- `payroll`: è–ªèµ„ç®¡ç†ç›¸å…³é¡µé¢å’ŒåŠŸèƒ½
- `employee`: å‘˜å·¥ç®¡ç†ç›¸å…³é¡µé¢å’ŒåŠŸèƒ½
- `admin`: ç³»ç»Ÿç®¡ç†å’Œæƒé™ç›¸å…³åŠŸèƒ½

## ğŸš€ åº”æ€¥å¤„ç†æ–¹æ¡ˆ

**âš¡ å¿«é€Ÿä¿®å¤æ¨¡å¼:**

å½“é‡åˆ°ç´§æ€¥æƒ…å†µéœ€è¦å¿«é€Ÿä¿®å¤æ—¶ï¼š

1. **ä¸´æ—¶ä¿®å¤** - æ·»åŠ ç¼ºå¤± key åˆ°å¯¹åº”ç¿»è¯‘æ–‡ä»¶
2. **ä¿æŒä¸€è‡´** - ç¡®ä¿ä¸­è‹±æ–‡ç¿»è¯‘æ–‡ä»¶åŒæ­¥æ›´æ–°
3. **è®°å½•é—®é¢˜** - åœ¨ [i18n_errors_collection.md](mdc:frontend/v2/i18n_errors_collection.md) ä¸­è®°å½•
4. **åç»­å®Œå–„** - è®¡åˆ’æ—¶é—´è¿›è¡Œç³»ç»Ÿæ€§ä¼˜åŒ–

## ğŸ“Š ç›‘æ§ä¸é¢„é˜²

**ğŸ” æŒç»­ç›‘æ§:**
- æ¯æ¬¡ PR å®¡æŸ¥æ—¶æ£€æŸ¥æ–°å¢çš„ç¿»è¯‘ key
- å®šæœŸè¿è¡Œ `npm run i18n:scan` æ£€æŸ¥å®Œæ•´æ€§
- åœ¨ CI/CD ä¸­é›†æˆç¿»è¯‘æ£€æŸ¥æ­¥éª¤

**ğŸ›¡ï¸ é¢„é˜²æªæ–½:**
- ä½¿ç”¨ ESLint æ’ä»¶æ£€æŸ¥ç¡¬ç¼–ç æ–‡æœ¬
- ä»£ç æ¨¡æ¿ä¸­åŒ…å«æ­£ç¡®çš„ i18n ç”¨æ³•
- å¼€å‘æ–‡æ¡£ä¸­å¼ºè°ƒç¿»è¯‘è§„èŒƒ

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [I18N_GUIDELINES.md](mdc:frontend/v2/I18N_GUIDELINES.md) - è¯¦ç»†çš„ i18n ä½¿ç”¨æŒ‡å—
- [i18n_errors_collection.md](mdc:frontend/v2/i18n_errors_collection.md) - é”™è¯¯æ”¶é›†è®°å½•
- [i18next-parser.config.cjs](mdc:frontend/v2/i18next-parser.config.cjs) - è‡ªåŠ¨æå–å·¥å…·é…ç½®

---

ğŸ’¡ **æç¤º**: éµå¾ªæ­¤æµç¨‹å¯ä»¥ç¡®ä¿ i18n ç¿»è¯‘é—®é¢˜å¾—åˆ°å¿«é€Ÿã€ç³»ç»Ÿæ€§çš„è§£å†³ï¼Œæå‡æ•´ä½“ä»£ç è´¨é‡å’Œç”¨æˆ·ä½“éªŒã€‚
